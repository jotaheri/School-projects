{"version":3,"file":"smartmenus.browser.min.js","sources":["../../src/js/utility/dom-data.js","../../src/js/utility/dom-events.js","../../src/js/utility/mouse-input-detect.js","../../src/js/utility/dom-helpers.js","../../src/js/utility/dom-query.js","../../src/js/defaults.js","../../src/js/index.js"],"sourcesContent":["/*\n * SmartMenus\n * http://www.smartmenus.org/\n * Copyright (c) since 2001 Vasil Dinkov, Vadikom Web Ltd. http://vadikom.com\n * Licensed MIT https://github.com/vadikom/smartmenus/blob/master/LICENSE-MIT\n */\n\nconst storage = new WeakMap()\n\nconst Data = {\n  set(element, key, value) {\n    if (!storage.has(element)) {\n      storage.set(element, new Map())\n    }\n\n    storage.get(element).set(key, value)\n  },\n\n  get(element, key) {\n    return storage.has(element) ? (storage.get(element).get(key) || null) : null\n  },\n\n  delete(element, key) {\n    if (storage.has(element)) {\n      return storage.get(element).delete(key)\n    }\n\n    return false\n  }\n}\n\nexport default Data\n","/*\n * SmartMenus\n * http://www.smartmenus.org/\n * Copyright (c) since 2001 Vasil Dinkov, Vadikom Web Ltd. http://vadikom.com\n * Licensed MIT https://github.com/vadikom/smartmenus/blob/master/LICENSE-MIT\n */\n\nimport Data from './dom-data.js'\n\nconst DATA_KEY = 'sm-events'\n\nfunction normalizeArguments(events, selector, handler) {\n  if (!handler && typeof selector === 'function') {\n    handler = selector\n    selector = ''\n  }\n\n  if (!events || typeof events === 'string') {\n    const eventsObject = {}\n    eventsObject[events || ''] = handler\n    events = eventsObject\n  }\n\n  if (!selector) {\n    selector = ''\n  }\n\n  // Support space separated events\n  const eventsObject = {}\n  for (const key of Object.keys(events)) {\n    for (const event of key.split(' ')) {\n      eventsObject[event] = events[key]\n    }\n  }\n\n  events = eventsObject\n\n  return [events, selector]\n}\n\nfunction parseEventNameAndNS(value) {\n  const eventNameAndNS = value.split('.')\n  return [eventNameAndNS[0], eventNameAndNS[1] || '']\n}\n\nconst Events = {\n  // Add a namespace to multiple events\n  getEventsNS(events, ns = '') {\n    const eventsNS = {}\n    for (const key of Object.keys(events)) {\n      eventsNS[key.split(' ').join(`${ns} `) + ns] = events[key]\n    }\n\n    return eventsNS\n  },\n\n  off(element, events, selector, handler) {\n    const storage = Data.get(element, DATA_KEY)\n    if (!storage) {\n      return\n    }\n\n    [events, selector] = normalizeArguments(events, selector, handler)\n\n    for (const key of Object.keys(events)) {\n      const handler = events[key]\n      if (handler && !storage.has(handler)) {\n        return\n      }\n\n      const [eventName, eventNS] = parseEventNameAndNS(key)\n      const handlersToDelete = []\n      const handlersStorage = handler ? new Map().set(handler, storage.get(handler)) : storage\n\n      for (const [handler, handlerStorage] of handlersStorage) {\n        handlerStorage.eventHandlers = handlerStorage.eventHandlers.filter(eventHandler => {\n          let keep = false\n          if (eventName) {\n            keep = !(eventName === eventHandler.eventName && (!eventNS || eventNS === eventHandler.eventNS) && (!selector || selector === eventHandler.selector))\n          } else if (eventNS) {\n            keep = !(eventNS === eventHandler.eventNS && (!selector || selector === eventHandler.selector))\n          } else if (selector) {\n            keep = selector !== eventHandler.selector\n          }\n\n          if (!keep) {\n            element.removeEventListener(eventHandler.eventName, eventHandler.realHandler, Boolean(eventHandler.selector))\n          }\n\n          return keep\n        })\n        if (handlerStorage.eventHandlers.length === 0) {\n          handlersToDelete.push(handler)\n        }\n      }\n\n      for (const handler of handlersToDelete) {\n        storage.delete(handler)\n      }\n    }\n  },\n\n  on(element, events, selector, handler) {\n    let storage = Data.get(element, DATA_KEY)\n    if (!storage) {\n      storage = new Map()\n      Data.set(element, DATA_KEY, storage)\n    }\n\n    [events, selector] = normalizeArguments(events, selector, handler)\n\n    for (const key of Object.keys(events)) {\n      const handler = events[key]\n      const [eventName, eventNS] = parseEventNameAndNS(key)\n      const realHandler = selector\n        ? (/^mouse(enter|leave)$/.test(eventName)\n          ? function (event) {\n            const { target } = event\n            if (target && target.matches && target.matches(selector) && element.contains(target)) {\n              handler.call(target, event, target)\n            }\n          }\n          : function (event) {\n            const { target } = event\n            const closest = target && target.closest && target.closest(selector)\n            if (closest && element.contains(closest)) {\n              handler.call(closest, event, closest)\n            }\n          })\n        : function (event) {\n          handler.call(element, event, element)\n        }\n\n      if (!storage.has(handler)) {\n        storage.set(handler, { eventHandlers: [] })\n      }\n\n      const handlerStorage = storage.get(handler)\n      handlerStorage.eventHandlers.push({\n        eventName,\n        eventNS,\n        selector,\n        realHandler\n      })\n      element.addEventListener(eventName, realHandler, Boolean(selector))\n    }\n  },\n\n  trigger(element, eventName, data) {\n    const event = new CustomEvent(eventName, { bubbles: true, cancelable: true, detail: data || null })\n    element.dispatchEvent(event)\n    return event\n  }\n}\n\nexport default Events\n","/*\n * SmartMenus\n * http://www.smartmenus.org/\n * Copyright (c) since 2001 Vasil Dinkov, Vadikom Web Ltd. http://vadikom.com\n * Licensed MIT https://github.com/vadikom/smartmenus/blob/master/LICENSE-MIT\n */\n\nimport Events from './dom-events.js'\n\nconst DATA_KEY = 'sm-mouse'\nconst EVENTS_NS = `.${DATA_KEY}`\n\nlet supportMouseInput // true/false when detection is enabled, undefined when detection is disabled\nconst supportPointerEvents = typeof window === 'undefined' ? false : Boolean(window.PointerEvent)\n\nconst MouseInputDetect = {\n  get supportMouseInput() {\n    return supportMouseInput\n  },\n\n  disable() {\n    if (supportMouseInput !== undefined) {\n      Events.off(document, EVENTS_NS)\n      supportMouseInput = undefined\n    }\n  },\n\n  enable(callbackOnFirstDetection) {\n    if (supportMouseInput === undefined) {\n      supportMouseInput = false\n      // If we get two consecutive mousemoves within 4 pixels from each other and within 300ms, we assume a real mouse/cursor is present\n      // in practice, this seems like impossible to trick unintentianally with a real mouse and a pretty safe detection on touch devices (even with older browsers that do not support touch events)\n      let isFirstDetection = true\n      let lastMove = null\n      const events = {\n        mousemove(event) {\n          const thisMove = { x: event.pageX, y: event.pageY, timeStamp: Date.now() }\n          if (lastMove) {\n            const deltaX = Math.abs(lastMove.x - thisMove.x)\n            const deltaY = Math.abs(lastMove.y - thisMove.y)\n            if ((deltaX > 0 || deltaY > 0) && deltaX <= 4 && deltaY <= 4 && thisMove.timeStamp - lastMove.timeStamp <= 300) {\n              supportMouseInput = true\n              if (isFirstDetection) {\n                if (callbackOnFirstDetection) {\n                  callbackOnFirstDetection(event)\n                }\n\n                isFirstDetection = false\n              }\n            }\n          }\n\n          lastMove = thisMove\n        }\n      }\n\n      events[supportPointerEvents ? 'pointerover pointermove pointerout' : 'touchstart'] = event => {\n        if (!/^(4|mouse)$/.test(event.pointerType)) {\n          supportMouseInput = false\n        }\n      }\n\n      Events.on(document, Events.getEventsNS(events, EVENTS_NS))\n    }\n  }\n}\n\nexport default MouseInputDetect\n","/*\n * SmartMenus\n * http://www.smartmenus.org/\n * Copyright (c) since 2001 Vasil Dinkov, Vadikom Web Ltd. http://vadikom.com\n * Licensed MIT https://github.com/vadikom/smartmenus/blob/master/LICENSE-MIT\n */\n\nconst Helpers = {\n  getComputedStyle(element) {\n    return Helpers.getWindow(element).getComputedStyle(element)\n  },\n\n  getDocument(element) {\n    return (element && element.ownerDocument) || window.document\n  },\n\n  getHeight(element) {\n    return Helpers._getDimensions(element, true)\n  },\n\n  getViewportHeight(element) {\n    return Helpers._getViewportDimensions(element, true)\n  },\n\n  getViewportWidth(element) {\n    return Helpers._getViewportDimensions(element)\n  },\n\n  getWidth(element) {\n    return Helpers._getDimensions(element)\n  },\n\n  getWindow(element) {\n    const ownerDocument = element && element.ownerDocument\n    return (ownerDocument && ownerDocument.defaultView) || window\n  },\n\n  _getDimensions(element, height) {\n    const elementStyle = element.style\n    let oldStyle = null\n    if (Helpers.getComputedStyle(element).display === 'none') {\n      oldStyle = { position: elementStyle.position, visibility: elementStyle.visibility, display: elementStyle.display }\n      elementStyle.position = 'absolute'\n      elementStyle.visibility = 'hidden'\n      elementStyle.display = 'block'\n    }\n\n    const value = element.getBoundingClientRect()[height ? 'height' : 'width']\n    if (oldStyle) {\n      elementStyle.display = oldStyle.display\n      elementStyle.position = oldStyle.position\n      elementStyle.visibility = oldStyle.visibility\n    }\n\n    return value\n  },\n\n  _getViewportDimensions(element, height) {\n    const _window = Helpers.getWindow(element)\n    const { visualViewport } = _window\n    if (visualViewport) {\n      return visualViewport[height ? 'height' : 'width']\n    }\n\n    const _document = Helpers.getDocument(element)\n    const name = height ? 'Height' : 'Width'\n    const value = _document.documentElement[`client${name}`]\n    const value2 = _window[`inner${name}`]\n    return value2 ? Math.min(value, value2) : value\n  }\n}\n\nexport default Helpers\n","/*\n * SmartMenus\n * http://www.smartmenus.org/\n * Copyright (c) since 2001 Vasil Dinkov, Vadikom Web Ltd. http://vadikom.com\n * Licensed MIT https://github.com/vadikom/smartmenus/blob/master/LICENSE-MIT\n */\n\nconst Query = {\n  get(selector, element = document.documentElement) {\n    return element.querySelector(selector)\n  },\n\n  getAll(selector, element = document.documentElement) {\n    return [...element.querySelectorAll(selector)]\n  },\n\n  closest(element, matchFunction) {\n    let closest = null\n\n    while (element) {\n      if (matchFunction(element)) {\n        closest = element\n        break\n      }\n\n      element = element.parentElement\n    }\n\n    return closest\n  },\n\n  parentsUntil(element, selector, filter) {\n    const parents = []\n    let parent = element.parentElement\n\n    while (parent && !parent.matches(selector)) {\n      if (!filter || parent.matches(filter)) {\n        parents.push(parent)\n      }\n\n      parent = parent.parentElement\n    }\n\n    return parents\n  }\n}\n\nexport default Query\n","/*\n * SmartMenus\n * http://www.smartmenus.org/\n * Copyright (c) since 2001 Vasil Dinkov, Vadikom Web Ltd. http://vadikom.com\n * Licensed MIT https://github.com/vadikom/smartmenus/blob/master/LICENSE-MIT\n */\n\nconst DEFAULTS = {\n  collapsibleActivateSelectedLinkOnInit: false,\n  collapsibleBehaviorAccordion: false,\n  collapsibleResetSubsOnClickOn: 'toggler',\n  dropdownsShowTrigger: 'click',\n  dropdownsShowTimeout: 250,\n  dropdownsHideTrigger: 'click',\n  dropdownsHideTimeout: 500,\n  dropdownsDropReverseX: false,\n  dropdownsDropReverseY: false,\n  dropdownsNavSubOffsetX: 0,\n  dropdownsNavSubOffsetY: 0,\n  dropdownsSubSubOffsetX: 0,\n  dropdownsSubSubOffsetY: 0,\n  dropdownsKeepInViewport: true,\n  markCurrentLinkAsSelectedOnInit: false,\n  markCurrentLinkParentsAsSelected: false,\n  resetTogglerOnLinkSelect: false,\n  showSubOnSplitLinkSelect: false,\n  classNavbarVertical: 'sm-navbar--vertical',\n  classNavbarDropReverseY: 'sm-navbar--drop-reverse-y',\n  classNavbarDropReverseX: 'sm-navbar--drop-reverse-x',\n  classSubMega: 'sm-sub--mega',\n  classLinkExpanded: 'sm-expanded',\n  classLinkSelected: 'sm-selected',\n  classLinkDisabled: 'sm-disabled',\n  classLinkHasSub: 'sm-has-sub',\n  classShow: 'sm-show',\n  classShowing: 'sm-showing',\n  classHiding: 'sm-hiding',\n  selectorTogglerState: '.sm-toggler-state',\n  selectorTogglerAnchorShow: '.sm-toggler-anchor--show',\n  selectorTogglerAnchorHide: '.sm-toggler-anchor--hide',\n  selectorCollapse: '.sm-collapse',\n  selectorOffcanvas: '.sm-offcanvas',\n  selectorOffcanvasOverlay: '.sm-offcanvas-overlay',\n  selectorNav: '.sm-nav',\n  selectorSub: '.sm-sub',\n  selectorItem: '.sm-nav-item, .sm-sub-item',\n  selectorLink: '.sm-nav-link, .sm-sub-link',\n  selectorLinkSplit: '.sm-nav-link--split, .sm-sub-link--split'\n}\n\nexport default DEFAULTS\n","/*\n * SmartMenus\n * http://www.smartmenus.org/\n * Copyright (c) since 2001 Vasil Dinkov, Vadikom Web Ltd. http://vadikom.com\n * Licensed MIT https://github.com/vadikom/smartmenus/blob/master/LICENSE-MIT\n */\n\nimport Data from './utility/dom-data.js'\nimport Events from './utility/dom-events.js'\nimport Helpers from './utility/dom-helpers.js'\nimport Query from './utility/dom-query.js'\nimport MouseInputDetect from './utility/mouse-input-detect.js'\nimport DEFAULTS from './defaults.js'\n\nconst DATA_KEY = 'sm'\nconst DATA_SUFFIX = `-${DATA_KEY}`\nconst DATA_ATTRIBUTE_PREFIX = `data-${DATA_KEY}-`\nconst EVENTS_NS = `.${DATA_KEY}`\nconst API_EVENTS_SUFFIX = `-${DATA_KEY}`\n\nconst navbars = []\n\nclass SmartMenus {\n  constructor(element, options) {\n    this._navbar = element\n\n    // Get any options defined as data- attributes\n    const dataOptions = {}\n    for (const key of Object.keys(DEFAULTS)) {\n      let dataValue = this._navbar.dataset[`${DATA_KEY}${key.charAt(0).toUpperCase()}${key.slice(1)}`]\n      if (dataValue !== undefined) {\n        switch (typeof DEFAULTS[key]) {\n          case 'number': {\n            dataValue = Number.parseFloat(dataValue, 10)\n            break\n          }\n\n          case 'boolean': {\n            dataValue = dataValue === 'true'\n            break\n          }\n        }\n\n        dataOptions[key] = dataValue\n      }\n    }\n\n    this._opts = { ...DEFAULTS, ...options, ...dataOptions }\n    this._togglerState = null\n    this._togglerAnchorShow = null\n    this._togglerAnchorHide = null\n    this._collapse = null\n    this._offcanvas = null\n    this._offcanvasOverlay = null\n    this._nav = null\n    this._navbarId = String(Date.now() + Math.random()).replace(/\\D/g, '') // for internal use\n    this._accessIdPrefix = `${DATA_KEY}-${this._navbarId}-`\n    this._visibleSubs = [] // stores visible subs (might be in no particular order in collapsible non-accordion mode)\n    this._dropdownsShowTimeout = 0\n    this._dropdownsHideTimeout = 0\n    this._clickActivated = false\n    this._zIndexInc = 0\n    this._idInc = 0\n    this._disabled = false\n    this._wasCollapsible = false\n\n    // We'll access these for some tests at runtime so we'll cache them\n    this._firstLink = null\n    this._firstSub = null\n\n    this._init()\n  }\n\n  // Getters\n  static get DATA_KEY() {\n    return DATA_KEY\n  }\n\n  static get Dom() {\n    return { Data, Events, Helpers, Query }\n  }\n\n  static get MouseInputDetect() {\n    return MouseInputDetect\n  }\n\n  static get navbars() {\n    return navbars\n  }\n\n  // Public\n  destroy(refresh) {\n    this.subHideAll()\n\n    if (this._nav) {\n      this._destroySubs()\n      this._destroyNav()\n      this._nav = null\n    }\n\n    this._togglerState = null\n    if (this._togglerAnchorShow) {\n      Data.delete(this._togglerAnchorShow, `beforefirstshow-fired${DATA_SUFFIX}`)\n      this._togglerAnchorShow = null\n    }\n\n    this._togglerAnchorHide = null\n    this._collapse = null\n    this._offcanvas = null\n    this._offcanvasOverlay = null\n    this._firstLink = null\n    this._firstSub = null\n\n    if (!refresh) {\n      this._destroyNavbar()\n      this._navbar = null\n    }\n  }\n\n  disable() {\n    if (!this._disabled) {\n      this.subHideAll()\n      this._disabled = true\n    }\n  }\n\n  enable() {\n    if (this._disabled) {\n      this._disabled = false\n    }\n  }\n\n  /**\n   * Activate a menu link\n   *\n   * @param {HTMLElement} element                       Any element which matches the \"selectorLink\" selector\n   * @param {('none'|'same'|'deeper'|'self')} hideSubs  Hide any visible subs from the same or deeper levels or only the self sub (if it exists)\n   * @param {boolean} showSub                           Should the link's sub be shown (if it exists)?\n   * @returns {void}\n   */\n  linkActivate(element, hideSubs = 'none', showSub = true) {\n    const menu = element.closest(`${this._opts.selectorNav}, ${this._opts.selectorSub}`)\n    const level = Data.get(menu, `level${DATA_SUFFIX}`)\n    const sub = Data.get(element, `sub${DATA_SUFFIX}`)\n\n    // If for some reason the containing menu is not visible (e.g. this is an API call to activate the link), show all parent menus first\n    if (level > 1 && !this._subIsVisible(menu)) {\n      const parents = Query.parentsUntil(menu, this._opts.selectorNav, this._opts.selectorSub).reverse()\n      parents.push(menu)\n      for (const menu of parents) {\n        this.linkActivate(Data.get(menu, `parent-link${DATA_SUFFIX}`), this._isCollapsible() && !this._opts.collapsibleBehaviorAccordion ? 'none' : 'same')\n      }\n    }\n\n    // Hide any visible subs\n    switch (hideSubs) {\n      case 'same': {\n        this._subHideSubs(level - 1)\n        break\n      }\n\n      case 'deeper': {\n        this._subHideSubs(level)\n        break\n      }\n\n      case 'self': {\n        if (sub) {\n          this._subHide(sub)\n        }\n\n        break\n      }\n    }\n\n    if (Events.trigger(this._navbar, `activate${API_EVENTS_SUFFIX}`, element).defaultPrevented || !showSub) {\n      return\n    }\n\n    // Show the sub menu if this link has one\n    if (sub) {\n      this._subShow(sub)\n    }\n  }\n\n  refresh() {\n    this.destroy(true)\n    this._init(true)\n  }\n\n  subHideAll() {\n    this._clearTimeout(this._dropdownsShowTimeout)\n    this._clearTimeout(this._dropdownsHideTimeout)\n\n    const visibleCount = this._visibleSubs.length\n\n    if (visibleCount > 0) {\n      for (const sub of [...this._visibleSubs].reverse()) {\n        this._subHide(sub)\n      }\n    }\n\n    this._visibleSubs = []\n    this._clickActivated = false\n    this._zIndexInc = 0\n\n    if (visibleCount > 0) {\n      Events.trigger(this._navbar, `hideall${API_EVENTS_SUFFIX}`)\n    }\n  }\n\n  // Private\n  _activateSelectedLink() {\n    const selectedLink = Query.getAll(`.${this._opts.classLinkSelected}`, this._nav).pop()\n    if (selectedLink) {\n      this.linkActivate(selectedLink)\n    }\n  }\n\n  _animate(element, classAnimate) {\n    // Reflow to make sure the animation would be restarted\n    void element.offsetWidth\n\n    element.classList.add(classAnimate)\n    const { animationDuration } = Helpers.getComputedStyle(element)\n    if (!animationDuration || animationDuration.startsWith('0s')) {\n      element.classList.remove(classAnimate)\n      return\n    }\n\n    // Trigger animationend if animation needs to be stopped or just in case it isn't fired for some reason\n    const endTimeout = Data.get(element, `animationend-timeout${DATA_SUFFIX}`)\n    if (endTimeout) {\n      window.clearTimeout(endTimeout)\n      Data.get(element, `animationend-trigger${DATA_SUFFIX}`)()\n    }\n\n    const endTrigger = () => {\n      Data.delete(element, `animationend-timeout${DATA_SUFFIX}`)\n      Data.delete(element, `animationend-trigger${DATA_SUFFIX}`)\n      if (element.classList.contains(classAnimate)) {\n        Events.trigger(element, 'animationend')\n      }\n    }\n\n    Data.set(element, `animationend-trigger${DATA_SUFFIX}`, endTrigger)\n    Data.set(element, `animationend-timeout${DATA_SUFFIX}`, window.setTimeout(endTrigger, (Number.parseFloat(animationDuration) * 1000) + 1)\n    )\n\n    Events.on(element, `animationend${EVENTS_NS}`, event => {\n      if (event.target === element) {\n        Events.off(element, `animationend${EVENTS_NS}`)\n        element.classList.remove(classAnimate)\n      }\n    })\n  }\n\n  _animateHide(element) {\n    // This property is used for the expand/collapse animation\n    element.style.setProperty(`--${DATA_KEY}-height`, `${Helpers.getHeight(element)}px`)\n    element.classList.remove(this._opts.classShow)\n    this._animate(element, this._opts.classHiding)\n  }\n\n  _animateShow(element) {\n    // This property is used for the expand/collapse animation\n    element.style.setProperty(`--${DATA_KEY}-height`, `${Helpers.getHeight(element)}px`)\n    element.classList.add(this._opts.classShow)\n    this._animate(element, this._opts.classShowing)\n  }\n\n  _clearTimeout(timeout) {\n    if (timeout) {\n      window.clearTimeout(timeout)\n      timeout = 0\n    }\n  }\n\n  _destroyLink(element) {\n    if (element.classList.contains(this._opts.classLinkHasSub)) {\n      if ((element.getAttribute('id') || '').startsWith(this._accessIdPrefix)) {\n        element.removeAttribute('id')\n      }\n\n      element.classList.remove(this._opts.classLinkHasSub)\n      Data.delete(element, `sub${DATA_SUFFIX}`)\n      Data.delete(element, `toggler${DATA_SUFFIX}`)\n      Data.delete(element, `link${DATA_SUFFIX}`)\n      element.removeAttribute('role')\n      element.removeAttribute('aria-controls')\n      element.removeAttribute('aria-expanded')\n    }\n\n    if (this._opts.markCurrentLinkAsSelectedOnInit && element.classList.contains(this._opts.classLinkSelected)) {\n      element.classList.remove(this._opts.classLinkSelected)\n      element.removeAttribute('aria-current')\n    }\n  }\n\n  _destroyNav() {\n    Data.delete(this._nav, `level${DATA_SUFFIX}`)\n    Events.off(this._nav, EVENTS_NS)\n    Events.off(window.document, `${EVENTS_NS}-${this._navbarId}`)\n    Events.off(window, `${EVENTS_NS}-${this._navbarId}`)\n  }\n\n  _destroyNavbar() {\n    Data.delete(this._navbar, DATA_KEY)\n    this._navbar.removeAttribute(`${DATA_ATTRIBUTE_PREFIX}id`)\n    Events.off(this._navbar, EVENTS_NS)\n    navbars.splice(navbars.indexOf(this), 1)\n  }\n\n  _destroySub(element) {\n    const shownBefore = Data.get(element, `shown-before${DATA_SUFFIX}`)\n    if (shownBefore) {\n      this._subResetPosition(element)\n    }\n\n    if ((element.getAttribute('id') || '').startsWith(this._accessIdPrefix)) {\n      element.removeAttribute('id')\n    }\n\n    Data.delete(element, `shown-before${DATA_SUFFIX}`)\n    Data.delete(element, `parent-link${DATA_SUFFIX}`)\n    Data.delete(element, `level${DATA_SUFFIX}`)\n    Data.delete(element, `beforefirstshow-fired${DATA_SUFFIX}`)\n    element.removeAttribute('aria-hidden')\n    element.removeAttribute('aria-labelledby')\n  }\n\n  _destroySubs() {\n    for (const sub of Query.getAll(this._opts.selectorSub, this._nav)) {\n      this._destroySub(sub)\n    }\n\n    // Let's process the links separately from the subs (unline on init) since some link might possibly be disconnected\n    // from the sub it had on init (e.g. its sub might have been removed in some DOM operation)\n    for (const link of Query.getAll(this._opts.selectorLink, this._nav)) {\n      this._destroyLink(link)\n    }\n  }\n\n  _docClick(event) {\n    // Hide on any click outside the nav\n    const isCollapsible = this._isCollapsible()\n    if (((!isCollapsible && this._opts.dropdownsHideTrigger === 'click') || (isCollapsible && this._opts.collapsibleResetSubsOnClickOn === 'page')) && (!event.target || !this._nav.contains(event.target))) {\n      this.subHideAll()\n    }\n  }\n\n  _docTouchEnd() {\n    if (!this._lastTouch) {\n      return\n    }\n\n    if ((this._lastTouch.x2 === undefined || this._lastTouch.x1 === this._lastTouch.x2) && (this._lastTouch.y2 === undefined || this._lastTouch.y1 === this._lastTouch.y2)) {\n      this._clearTimeout(this._dropdownsHideTimeout)\n\n      // Call with a delay to prevent triggering accidental unwanted click on some page element\n      const { target } = this._lastTouch\n      this._dropdownsHideTimeout = window.setTimeout(() => {\n        this._docClick({ target })\n      }, 350)\n    }\n\n    this._lastTouch = null\n  }\n\n  _docTouchMove(event) {\n    if (!this._lastTouch) {\n      return\n    }\n\n    const touchPoint = event.touches[0]\n    this._lastTouch.x2 = touchPoint.pageX\n    this._lastTouch.y2 = touchPoint.pageY\n  }\n\n  _docTouchStart(event) {\n    const touchPoint = event.touches[0]\n    this._lastTouch = { x1: touchPoint.pageX, y1: touchPoint.pageY, target: touchPoint.target }\n  }\n\n  _getRootZIndex() {\n    const zIndex = Number.parseInt(Helpers.getComputedStyle(this._navbar).zIndex, 10)\n    return Number.isNaN(zIndex) ? 1 : zIndex\n  }\n\n  _handleEvents() {\n    return !this._disabled && this._isCSSOn()\n  }\n\n  _init(refresh) {\n    if (this._navbar.classList.contains(this._opts.classNavbarDropReverseX)) {\n      this._opts.dropdownsDropReverseX = true\n    }\n\n    if (this._navbar.classList.contains(this._opts.classNavbarDropReverseY)) {\n      this._opts.dropdownsDropReverseY = true\n    }\n\n    this._togglerState = Query.get(this._opts.selectorTogglerState, this._navbar)\n    this._togglerAnchorShow = Query.get(this._opts.selectorTogglerAnchorShow, this._navbar)\n    this._togglerAnchorHide = Query.get(this._opts.selectorTogglerAnchorHide, this._navbar)\n    this._collapse = Query.get(this._opts.selectorCollapse, this._navbar)\n    this._offcanvas = Query.get(this._opts.selectorOffcanvas, this._navbar)\n    this._offcanvasOverlay = Query.get(this._opts.selectorOffcanvasOverlay, this._navbar)\n    this._nav = Query.get(this._opts.selectorNav, this._navbar)\n\n    if (!refresh) {\n      this._initNavbar()\n    }\n\n    if (this._nav) {\n      this._initNav()\n      this._initSubs()\n\n      // Save initial state\n      const isCollapsible = this._isCollapsible()\n      this._wasCollapsible = isCollapsible\n\n      if (this._opts.markCurrentLinkAsSelectedOnInit) {\n        this._markCurrentLinkAsSelected()\n      }\n\n      if (this._opts.collapsibleActivateSelectedLinkOnInit && isCollapsible) {\n        this._activateSelectedLink()\n      }\n\n      MouseInputDetect.enable(\n        // On mouse input detected - check if we are not over some link by chance and call the mouseenter handler if yes\n        event => {\n          const { target } = event\n          if (target?.closest) {\n            navbars.some(object => {\n              const link = target.closest(object._opts.selectorLink)\n              if (link && object._navbar.contains(link)) {\n                object._linkEnter(event, link)\n                return true\n              }\n\n              return false\n            })\n          }\n        }\n      )\n    }\n  }\n\n  _initNav() {\n    Data.set(this._nav, `level${DATA_SUFFIX}`, 1)\n    Events.on(this._nav, Events.getEventsNS({\n      'mouseover focusin': this._navOver.bind(this),\n      'mouseout focusout': this._navOut.bind(this),\n      keydown: this._navKeyDown.bind(this)\n    }, EVENTS_NS))\n\n    Events.on(this._nav, Events.getEventsNS({\n      mouseenter: this._linkEnter.bind(this),\n      mouseleave: this._linkLeave.bind(this),\n      mousedown: this._linkDown.bind(this),\n      focus: this._linkFocus.bind(this),\n      blur: this._linkBlur.bind(this),\n      click: this._linkClick.bind(this)\n    }, EVENTS_NS), this._opts.selectorLink)\n  }\n\n  _initNavbar() {\n    navbars.push(this)\n    Data.set(this._navbar, DATA_KEY, this)\n    this._navbar.setAttribute(`${DATA_ATTRIBUTE_PREFIX}id`, this._navbarId)\n    Events.on(this._navbar, `click${EVENTS_NS}`, this._opts.selectorTogglerAnchorShow, this._togglerAnchorShowClick.bind(this))\n    Events.on(this._navbar, `click${EVENTS_NS}`, this._opts.selectorTogglerAnchorHide, this._togglerAnchorHideClick.bind(this))\n    Events.on(this._navbar, `click${EVENTS_NS}`, this._opts.selectorOffcanvasOverlay, this._offcanvasOverlayClick.bind(this))\n  }\n\n  _initSub(element) {\n    const parentLink = Query.get(this._opts.selectorLink, element.closest(this._opts.selectorItem))\n    parentLink.classList.add(this._opts.classLinkHasSub)\n    const parentLinkNextElement = parentLink.nextElementSibling\n    const parentLinkToggler = parentLinkNextElement?.matches(this._opts.selectorLinkSplit) && parentLink.matches(this._opts.selectorLinkSplit) ? parentLinkNextElement : null\n    if (parentLinkToggler) {\n      Data.set(parentLink, `toggler${DATA_SUFFIX}`, parentLinkToggler)\n      Data.set(parentLinkToggler, `link${DATA_SUFFIX}`, parentLink)\n      parentLinkToggler.classList.add(this._opts.classLinkHasSub)\n    }\n\n    Data.set(parentLink, `sub${DATA_SUFFIX}`, element)\n    Data.set(element, `parent-link${DATA_SUFFIX}`, parentLink)\n    Data.set(element, `level${DATA_SUFFIX}`, Query.parentsUntil(element, this._opts.selectorNav, this._opts.selectorSub).length + 2)\n\n    this._setTogglerSubARIA(parentLinkToggler || parentLink, element)\n  }\n\n  _initSubs() {\n    // Hide subs on tap or click outside the nav\n    if (this._opts.dropdownsHideTrigger === 'click' || this._opts.collapsibleResetSubsOnClickOn === 'page') {\n      Events.on(window.document, Events.getEventsNS({\n        touchstart: this._docTouchStart.bind(this),\n        touchmove: this._docTouchMove.bind(this),\n        touchend: this._docTouchEnd.bind(this),\n        click: this._docClick.bind(this)\n      }, `${EVENTS_NS}-${this._navbarId}`))\n    }\n\n    // Hide subs on resize\n    Events.on(window, Events.getEventsNS({\n      'resize orientationchange': this._winResize.bind(this)\n    }, `${EVENTS_NS}-${this._navbarId}`))\n\n    const subs = Query.getAll(this._opts.selectorSub, this._nav)\n    for (const sub of subs) {\n      this._initSub(sub)\n    }\n\n    // Cache these for faster access at runtime\n    this._firstLink = Query.get(this._opts.selectorLink, this._nav)\n    this._firstSub = subs[0]\n  }\n\n  _isCollapsible() {\n    return this._isCSSOn() && this._firstSub && Helpers.getComputedStyle(this._firstSub).position === 'static'\n  }\n\n  _isCSSOn() {\n    return this._firstLink && Helpers.getComputedStyle(this._firstLink).display !== 'inline'\n  }\n\n  _isTouchMode() {\n    return !MouseInputDetect.supportMouseInput || this._isCollapsible()\n  }\n\n  _linkBlur(event, element) {\n    if (!this._handleEvents()) {\n      return\n    }\n\n    // If this is a split link toggler, trigger the handler for the actual link\n    const link = Data.get(element, `link${DATA_SUFFIX}`)\n    if (link) {\n      this._linkBlur(event, link)\n      return\n    }\n\n    Events.trigger(this._navbar, `blur${API_EVENTS_SUFFIX}`, element)\n  }\n\n  /* eslint-disable complexity */\n  // Maybe refactor this to lower complexity?\n  _linkClick(event, element) {\n    if (!this._handleEvents()) {\n      return\n    }\n\n    if (element.classList.contains(this._opts.classLinkDisabled)) {\n      event.preventDefault()\n      return false\n    }\n\n    // If this is a split link toggler, get the actual link\n    let link = Data.get(element, `link${DATA_SUFFIX}`)\n    const isTogglerClicked = Boolean(link)\n    if (!isTogglerClicked) {\n      link = element\n    }\n\n    if (Events.trigger(this._navbar, `click${API_EVENTS_SUFFIX}`, link).defaultPrevented) {\n      event.preventDefault()\n      return false\n    }\n\n    const linkToggler = Data.get(link, `toggler${DATA_SUFFIX}`)\n    const sub = Data.get(link, `sub${DATA_SUFFIX}`)\n    const subIsVisible = sub && this._subIsVisible(sub)\n    const level = Data.get(sub, `level${DATA_SUFFIX}`) - 1\n    const isCollapsible = this._isCollapsible()\n    const selectLink = !sub || (linkToggler && !isTogglerClicked)\n\n    if (selectLink && Events.trigger(this._navbar, `select${API_EVENTS_SUFFIX}`, link).defaultPrevented) {\n      event.preventDefault()\n      return false\n    }\n\n    if (sub && (!selectLink || this._opts.showSubOnSplitLinkSelect)) {\n      this._clickActivated = this._clickActivated || Boolean(!isCollapsible && !subIsVisible && this._opts.dropdownsShowTrigger === 'click-then-mouseover' && level === 1)\n    }\n\n    // Activate link\n    let hideSubs = 'none'\n    if (subIsVisible && isCollapsible && !this._opts.collapsibleBehaviorAccordion && (!selectLink || !this._opts.showSubOnSplitLinkSelect)) {\n      hideSubs = 'self'\n    } else if (\n      (sub\n        && (\n          (subIsVisible && (!isCollapsible || this._opts.collapsibleBehaviorAccordion) && (!selectLink || !this._opts.showSubOnSplitLinkSelect))\n          || (!subIsVisible && (!isCollapsible || (this._opts.collapsibleBehaviorAccordion && (!selectLink || this._opts.showSubOnSplitLinkSelect))))\n        )\n      )\n      || (!sub && !isCollapsible)\n    ) {\n      hideSubs = 'same'\n    }\n\n    const showSub = selectLink ? this._opts.showSubOnSplitLinkSelect : !subIsVisible\n    this.linkActivate(link, hideSubs, showSub)\n\n    // Select link\n    if (selectLink) {\n      if (this._opts.resetTogglerOnLinkSelect && this._togglerAnchorHide && Helpers.getComputedStyle(this._togglerAnchorHide).display !== 'none' && this._togglerAnchorHide.offsetWidth > 0) {\n        this._togglerAnchorHide.click()\n      }\n\n      if (!isCollapsible && (!sub || subIsVisible || !this._opts.showSubOnSplitLinkSelect)) {\n        this.subHideAll()\n      }\n\n      return true\n    }\n\n    // Toggle sub\n    if (sub) {\n      if (!isCollapsible && level === 1 && subIsVisible) {\n        this.subHideAll()\n      }\n\n      event.preventDefault()\n      return false\n    }\n  }\n  /* eslint-enable complexity */\n\n  _linkDown(event, element) {\n    if (!this._handleEvents()) {\n      return\n    }\n\n    // If this is a split link toggler, trigger the handler for the actual link\n    const link = Data.get(element, `link${DATA_SUFFIX}`)\n    if (link) {\n      this._linkDown(event, link)\n      return\n    }\n\n    Data.set(element, `mousedown${DATA_SUFFIX}`, true)\n  }\n\n  _linkEnter(event, element) {\n    if (!this._handleEvents()) {\n      return\n    }\n\n    // If this is a split link toggler, trigger the handler for the actual link\n    const link = Data.get(element, `link${DATA_SUFFIX}`)\n    if (link) {\n      this._linkEnter(event, link)\n      return\n    }\n\n    if (!this._isTouchMode() && (this._opts.dropdownsShowTrigger === 'mouseover' || (this._opts.dropdownsShowTrigger === 'click-then-mouseover' && this._clickActivated) || this._opts.dropdownsHideTrigger !== 'click')) {\n      this._clearTimeout(this._dropdownsShowTimeout)\n\n      const level = Data.get(element.closest(`${this._opts.selectorNav}, ${this._opts.selectorSub}`), `level${DATA_SUFFIX}`)\n      const sub = Data.get(element, `sub${DATA_SUFFIX}`)\n      const hideSubs = !sub || !this._subIsVisible(sub) ? 'same' : 'deeper'\n      const showSub = this._opts.dropdownsShowTrigger === 'mouseover' || (this._opts.dropdownsShowTrigger === 'click-then-mouseover' && this._clickActivated)\n      const timeout = this._opts.dropdownsShowTrigger === 'click-then-mouseover' && level === 1 ? 1 : this._opts.dropdownsShowTimeout\n      this._dropdownsShowTimeout = window.setTimeout(() => {\n        this.linkActivate(element, hideSubs, showSub)\n      }, timeout)\n    }\n\n    Events.trigger(this._navbar, `mouseenter${API_EVENTS_SUFFIX}`, element)\n  }\n\n  _linkFocus(event, element) {\n    if (!this._handleEvents()) {\n      return\n    }\n\n    // If this is a split link toggler, trigger the handler for the actual link\n    const link = Data.get(element, `link${DATA_SUFFIX}`)\n    if (link) {\n      this._linkFocus(event, link)\n      return\n    }\n\n    // Neglect focus events that were triggered by mouse input\n    if (!Data.get(element, `mousedown${DATA_SUFFIX}`)) {\n      const sub = Data.get(element, `sub${DATA_SUFFIX}`)\n      const hideSubs = this._isCollapsible() && !this._opts.collapsibleBehaviorAccordion ? 'none' : (!sub || !this._subIsVisible(sub) ? 'same' : 'deeper')\n      const showSub = false\n      this.linkActivate(element, hideSubs, showSub)\n    }\n\n    Events.trigger(this._navbar, `focus${API_EVENTS_SUFFIX}`, element)\n  }\n\n  _linkLeave(event, element) {\n    if (!this._handleEvents()) {\n      return\n    }\n\n    // If this is a split link toggler, trigger the handler for the actual link\n    const link = Data.get(element, `link${DATA_SUFFIX}`)\n    if (link) {\n      this._linkLeave(event, link)\n      return\n    }\n\n    if (!this._isTouchMode() && this._opts.dropdownsHideTrigger !== 'click') {\n      element.blur()\n      const linkToggler = Data.get(element, `toggler${DATA_SUFFIX}`)\n      if (linkToggler) {\n        linkToggler.blur()\n      }\n\n      this._clearTimeout(this._dropdownsShowTimeout)\n    }\n\n    Data.delete(element, `mousedown${DATA_SUFFIX}`)\n\n    Events.trigger(this._navbar, `mouseleave${API_EVENTS_SUFFIX}`, element)\n  }\n\n  _navKeyDown(event) {\n    if (!this._handleEvents()) {\n      return\n    }\n\n    switch (event.keyCode) {\n      // Esc\n      case 27: {\n        const { target } = event\n        // If has own sub and it's visible, hide it\n        if (target?.matches(this._opts.selectorLink)) {\n          const link = Data.get(target, `link${DATA_SUFFIX}`) || target\n          const linkToggler = Data.get(link, `toggler${DATA_SUFFIX}`)\n          const element = linkToggler || link\n          const sub = Data.get(link, `sub${DATA_SUFFIX}`)\n          if (sub && this._subIsVisible(sub)) {\n            this._linkClick(event, element)\n            event.preventDefault()\n            return\n          }\n        }\n\n        // Hide closest sub\n        const closestSub = target?.closest(`${this._opts.selectorSub}`)\n        if (closestSub) {\n          const parentLink = Data.get(closestSub, `parent-link${DATA_SUFFIX}`)\n          const parentLinkToggler = Data.get(parentLink, `toggler${DATA_SUFFIX}`)\n          const element = parentLinkToggler || parentLink\n          this._linkClick(event, element)\n          element.focus()\n          event.preventDefault()\n        }\n\n        return\n      }\n\n      // Space\n      case 32: {\n        const { target } = event\n        // Toggle link's sub\n        if (target?.matches(this._opts.selectorLink)) {\n          this._linkClick(event, target)\n          event.preventDefault()\n        }\n      }\n    }\n  }\n\n  _navOut(event) {\n    if (!this._handleEvents() || this._isTouchMode() || event.target === this._nav) {\n      return\n    }\n\n    this._clearTimeout(this._dropdownsHideTimeout)\n\n    // On focusout if there is no related target (i.e. another page element that was focused) it means the page lost focus so do not hide the sub menus\n    if (this._opts.dropdownsHideTrigger !== 'click' || (event.type !== 'mouseout' && event.relatedTarget && (!event.target || !this._nav.contains(event.target)))) {\n      this._dropdownsHideTimeout = window.setTimeout(() => {\n        this.subHideAll()\n      }, this._opts.dropdownsHideTimeout)\n    }\n  }\n\n  _navOver(event) {\n    if (!this._handleEvents() || this._isTouchMode() || event.target === this._nav) {\n      return\n    }\n\n    this._clearTimeout(this._dropdownsHideTimeout)\n  }\n\n  _offcanvasOverlayClick(event) {\n    if (!this._handleEvents()) {\n      return\n    }\n\n    if (this._togglerAnchorHide) {\n      this._togglerAnchorHide.click()\n    }\n\n    event.preventDefault()\n  }\n\n  _markCurrentLinkAsSelected() {\n    const reDefaultDocument = /(index|default)\\.[^#/?]*/i\n    const reHash = /#.*/\n    const locHref = window.location.href.replace(reDefaultDocument, '')\n    const locHrefNoHash = locHref.replace(reHash, '')\n    for (const link of Query.getAll(this._opts.selectorLink, this._nav)) {\n      // if this is a split link toggler, skip it\n      if (Data.get(link, `link${DATA_SUFFIX}`)) {\n        continue\n      }\n\n      const href = link.href.replace(reDefaultDocument, '')\n      if (href === locHref || href === locHrefNoHash) {\n        link.classList.add(this._opts.classLinkSelected)\n        link.setAttribute('aria-current', 'page')\n        const linkToggler = Data.get(link, `toggler${DATA_SUFFIX}`)\n        if (linkToggler) {\n          linkToggler.classList.add(this._opts.classLinkSelected)\n        }\n\n        if (this._opts.markCurrentLinkParentsAsSelected) {\n          for (const sub of Query.parentsUntil(link, this._opts.selectorNav, this._opts.selectorSub)) {\n            const parentLink = Data.get(sub, `parent-link${DATA_SUFFIX}`)\n            parentLink.classList.add(this._opts.classLinkSelected)\n            const parentLinkToggler = Data.get(parentLink, `toggler${DATA_SUFFIX}`)\n            if (parentLinkToggler) {\n              parentLinkToggler.classList.add(this._opts.classLinkSelected)\n            }\n          }\n        }\n      }\n    }\n  }\n\n  _setTogglerSubARIA(togglerElement, subElement) {\n    const togglerId = togglerElement.getAttribute('id') || this._accessIdPrefix + (++this._idInc)\n    const subId = subElement.getAttribute('id') || this._accessIdPrefix + (++this._idInc)\n\n    togglerElement.setAttribute('id', togglerId)\n    togglerElement.setAttribute('role', 'button')\n    togglerElement.setAttribute('aria-controls', subId)\n    togglerElement.setAttribute('aria-expanded', 'false')\n\n    subElement.setAttribute('id', subId)\n    subElement.setAttribute('aria-hidden', 'true')\n    subElement.setAttribute('aria-labelledby', togglerId)\n  }\n\n  _subHide(element) {\n    if (!this._subIsVisible(element)) {\n      return\n    }\n\n    if (Events.trigger(this._navbar, `beforehide${API_EVENTS_SUFFIX}`, element).defaultPrevented) {\n      return\n    }\n\n    this._animateHide(element)\n    const parentLink = Data.get(element, `parent-link${DATA_SUFFIX}`)\n    parentLink.classList.remove(this._opts.classLinkExpanded)\n    const parentLinkToggler = Data.get(parentLink, `toggler${DATA_SUFFIX}`)\n    if (parentLinkToggler) {\n      parentLinkToggler.classList.remove(this._opts.classLinkExpanded)\n      parentLinkToggler.setAttribute('aria-expanded', 'false')\n    } else {\n      parentLink.setAttribute('aria-expanded', 'false')\n    }\n\n    element.setAttribute('aria-hidden', 'true')\n    this._visibleSubs.splice(this._visibleSubs.indexOf(element), 1)\n    Events.trigger(this._navbar, `hide${API_EVENTS_SUFFIX}`, element)\n  }\n\n  _subHideSubs(level) {\n    for (let index = this._visibleSubs.length - 1; index >= level; index--) {\n      this._subHide(this._visibleSubs[index])\n    }\n  }\n\n  _subIsVisible(element) {\n    return element.classList.contains(this._opts.classShow)\n  }\n\n  /* eslint-disable complexity */\n  // Maybe refactor this to lower complexity?\n  _subPosition(element) {\n    const parentItem = element.closest(this._opts.selectorItem)\n    const level = Data.get(element, `level${DATA_SUFFIX}`)\n    const mega = element.classList.contains(this._opts.classSubMega)\n    const vertical = this._navbar.classList.contains(this._opts.classNavbarVertical)\n    const horizontalParent = level === 2 && !vertical\n    const rtl = Helpers.getComputedStyle(this._navbar).direction === 'rtl'\n    let rightToLeft = (rtl && !this._opts.dropdownsDropReverseX) || (!rtl && this._opts.dropdownsDropReverseX)\n    if (parentItem.matches(`[${DATA_ATTRIBUTE_PREFIX}drop-reverse-x]`)) {\n      rightToLeft = !rightToLeft\n    }\n\n    let downToUp = this._opts.dropdownsDropReverseY\n    if (parentItem.matches(`[${DATA_ATTRIBUTE_PREFIX}drop-reverse-y]`)) {\n      downToUp = !downToUp\n    }\n\n    const xProperty = rightToLeft ? 'right' : 'left'\n    const xPropertyCapitalized = xProperty.charAt(0).toUpperCase() + xProperty.slice(1)\n    const yProperty = downToUp ? 'bottom' : 'top'\n    const yPropertyCapitalized = yProperty.charAt(0).toUpperCase() + yProperty.slice(1)\n    const parentItemRect = parentItem.getBoundingClientRect()\n    const parentItemRectX = parentItemRect[xProperty]\n    const parentItemRectY = parentItemRect[yProperty]\n    const parentItemWidth = Helpers.getWidth(parentItem)\n    const parentItemHeight = Helpers.getHeight(parentItem)\n    const subComputedStyle = Helpers.getComputedStyle(element)\n    const subOffsetX = level === 2 ? this._opts.dropdownsNavSubOffsetX : this._opts.dropdownsSubSubOffsetX\n    const subOffsetY = level === 2 && !vertical ? this._opts.dropdownsNavSubOffsetY : this._opts.dropdownsSubSubOffsetY - Number.parseFloat(subComputedStyle[`border${yPropertyCapitalized}Width`], 10) - Number.parseFloat(subComputedStyle[`padding${yPropertyCapitalized}`], 10)\n    let x = 0\n    let y = 0\n\n    if (horizontalParent) {\n      x = subOffsetX\n      y = parentItemHeight + subOffsetY\n    } else {\n      x = parentItemWidth + subOffsetX\n      y = subOffsetY\n    }\n\n    // Mega subs are not positioned against their parent item (as it has position: static) so compensate that\n    if (mega) {\n      // Find closest positioned parent (e.g. might be the navbar, offcanvas element)\n      const positionedParent = Query.closest(element.parentElement, parent => Helpers.getComputedStyle(parent).position !== 'static')\n      if (positionedParent) {\n        const positionedParentRect = positionedParent.getBoundingClientRect()\n        const positionedParentComputedStyle = Helpers.getComputedStyle(positionedParent)\n        if (horizontalParent) {\n          y += Math.abs(parentItemRectY - positionedParentRect[yProperty]) - Number.parseFloat(positionedParentComputedStyle[`border${yPropertyCapitalized}Width`], 10)\n        } else {\n          x += Math.abs(parentItemRectX - positionedParentRect[xProperty]) - Number.parseFloat(positionedParentComputedStyle[`border${xPropertyCapitalized}Width`], 10)\n        }\n      }\n    }\n\n    // Keep sub in viewport\n    if (this._opts.dropdownsKeepInViewport && !mega) {\n      const viewportWidth = Helpers.getViewportWidth()\n      const viewportHeight = Helpers.getViewportHeight()\n      const subWidth = Helpers.getWidth(element)\n      const subHeight = Helpers.getHeight(element)\n      const parentItemX = rightToLeft ? viewportWidth - parentItemRectX : parentItemRectX\n      const parentItemY = downToUp ? viewportHeight - parentItemRectY : parentItemRectY\n      if (subWidth < viewportWidth) {\n        if (horizontalParent) {\n          if (parentItemX + x + subWidth > viewportWidth) {\n            // Align against the opposite edge of the viewport\n            x = viewportWidth - subWidth - parentItemX\n          } else if (parentItemX + x < 0) {\n            // Align against the same edge of the viewport\n            x = -parentItemX\n          }\n        } else if (parentItemX + x + subWidth > viewportWidth) {\n          if (subOffsetX + subWidth <= parentItemX) {\n            // Flip position if there is enough space on the other side of the parent item\n            x = -subOffsetX - subWidth\n          } else if (parentItemX > viewportWidth - parentItemX - parentItemWidth + 1) {\n            // If there is no space for a flip, align it against the edge of the viewport where there is more space\n            // 1px added for consistent results when the space difference is only due to rounding\n            x = -parentItemX\n          } else {\n            x = viewportWidth - subWidth - parentItemX\n          }\n        }\n      } else {\n        // If the sub cannot fit inside the viewport, align it against the same edge of the viewport\n        x = -parentItemX\n      }\n\n      if (!horizontalParent) {\n        if (subHeight < viewportHeight) {\n          if (parentItemY + y + subHeight > viewportHeight) {\n            // Align against the opposite edge of the viewport\n            y = viewportHeight - subHeight - parentItemY\n          } else if (parentItemY + y < 0) {\n            // Align against the same edge of the viewport\n            y = -parentItemY\n          }\n        } else {\n          // If the sub cannot fit inside the viewport, align it against the top edge of the viewport\n          y = downToUp ? viewportHeight - subHeight - parentItemY : -parentItemY\n        }\n      }\n    }\n\n    const elementStyle = element.style\n    elementStyle.zIndex = this._zIndexInc = (this._zIndexInc || this._getRootZIndex()) + 1\n    if (mega) {\n      if (horizontalParent) {\n        elementStyle[yProperty] = y + 'px'\n      } else {\n        elementStyle[xProperty] = x + 'px'\n      }\n    } else {\n      elementStyle[xProperty] = x + 'px'\n      elementStyle[yProperty] = y + 'px'\n    }\n  }\n  /* eslint-enable complexity */\n\n  _subResetPosition(element) {\n    const elementStyle = element.style\n    elementStyle.zIndex = ''\n    elementStyle.top = ''\n    elementStyle.left = ''\n    elementStyle.bottom = ''\n    elementStyle.right = ''\n  }\n\n  _subShow(element) {\n    if (this._subIsVisible(element)) {\n      return\n    }\n\n    if (!Data.get(element, `beforefirstshow-fired${DATA_SUFFIX}`)) {\n      Data.set(element, `beforefirstshow-fired${DATA_SUFFIX}`, true)\n      if (Events.trigger(this._navbar, `beforefirstshow${API_EVENTS_SUFFIX}`, element).defaultPrevented) {\n        return\n      }\n    }\n\n    if (Events.trigger(this._navbar, `beforeshow${API_EVENTS_SUFFIX}`, element).defaultPrevented) {\n      return\n    }\n\n    Data.set(element, `shown-before${DATA_SUFFIX}`, true)\n\n    const parentLink = Data.get(element, `parent-link${DATA_SUFFIX}`)\n    parentLink.classList.add(this._opts.classLinkExpanded)\n    const parentLinkToggler = Data.get(parentLink, `toggler${DATA_SUFFIX}`)\n    if (parentLinkToggler) {\n      parentLinkToggler.classList.add(this._opts.classLinkExpanded)\n    }\n\n    const isCollapsible = this._isCollapsible()\n    if (isCollapsible) {\n      this._subResetPosition(element)\n    } else {\n      this._subPosition(element)\n    }\n\n    this._animateShow(element)\n    // Accessibility\n    if (parentLinkToggler) {\n      parentLinkToggler.setAttribute('aria-expanded', 'true')\n    } else {\n      parentLink.setAttribute('aria-expanded', 'true')\n    }\n\n    element.setAttribute('aria-hidden', 'false')\n    // Store sub menu in visible array\n    this._visibleSubs.push(element)\n    Events.trigger(this._navbar, `show${API_EVENTS_SUFFIX}`, element)\n  }\n\n  _togglerAnchorHideClick(event) {\n    if (!this._handleEvents()) {\n      return\n    }\n\n    if (Events.trigger(this._navbar, `beforehide${API_EVENTS_SUFFIX}`, this._collapse || this._offcanvas || null).defaultPrevented) {\n      return\n    }\n\n    if (this._opts.collapsibleResetSubsOnClickOn === 'toggler') {\n      this.subHideAll()\n    }\n\n    if (this._collapse) {\n      this._animateHide(this._collapse)\n    }\n\n    if (this._offcanvas) {\n      this._animateHide(this._offcanvas)\n    }\n\n    if (this._offcanvasOverlay) {\n      this._animateHide(this._offcanvasOverlay)\n    }\n\n    if (this._togglerState) {\n      this._togglerState.classList.remove(this._opts.classShow)\n      // Just in case try to remove the hash too\n      window.location.hash = window.location.hash.replace(new RegExp(`^#${this._togglerState.getAttribute('id')}$`), '')\n    }\n\n    if (this._togglerAnchorHide) {\n      this._togglerAnchorShow.focus()\n    }\n\n    event.preventDefault()\n    Events.trigger(this._navbar, `hide${API_EVENTS_SUFFIX}`, this._collapse || this._offcanvas || null)\n  }\n\n  _togglerAnchorShowClick(event, element) {\n    if (!this._handleEvents()) {\n      return\n    }\n\n    if (!Data.get(element, `beforefirstshow-fired${DATA_SUFFIX}`)) {\n      Data.set(element, `beforefirstshow-fired${DATA_SUFFIX}`, true)\n      if (Events.trigger(this._navbar, `beforefirstshow${API_EVENTS_SUFFIX}`, this._collapse || this._offcanvas || null).defaultPrevented) {\n        return\n      }\n    }\n\n    if (Events.trigger(this._navbar, `beforeshow${API_EVENTS_SUFFIX}`, this._collapse || this._offcanvas || null).defaultPrevented) {\n      return\n    }\n\n    if (this._collapse) {\n      this._animateShow(this._collapse)\n    }\n\n    if (this._offcanvas) {\n      this._animateShow(this._offcanvas)\n    }\n\n    if (this._offcanvasOverlay) {\n      this._animateShow(this._offcanvasOverlay)\n    }\n\n    if (this._togglerState) {\n      this._togglerState.classList.add(this._opts.classShow)\n    }\n\n    if (this._togglerAnchorHide) {\n      this._togglerAnchorHide.focus()\n    }\n\n    event.preventDefault()\n    Events.trigger(this._navbar, `show${API_EVENTS_SUFFIX}`, this._collapse || this._offcanvas || null)\n  }\n\n  _winResize(event) {\n    if (!this._handleEvents()) {\n      return\n    }\n\n    // Hide subs on resize - on mobile do it only on orientation change\n    if (!('onorientationchange' in window) || event.type === 'orientationchange') {\n      const isCollapsible = this._isCollapsible()\n      // If it was collapsible before resize and still is, don't do it\n      if (!(this._wasCollapsible && isCollapsible)) {\n        this.subHideAll()\n      }\n\n      this._wasCollapsible = isCollapsible\n    }\n  }\n\n  // Static\n  static destroy() {\n    while (navbars.length > 0) {\n      navbars[0].destroy()\n    }\n\n    MouseInputDetect.disable()\n  }\n\n  static subHideAll() {\n    for (const navbar of navbars) {\n      navbar.subHideAll()\n    }\n  }\n}\n\nexport default SmartMenus\n"],"names":["storage","WeakMap","Data","set","element","key","value","has","Map","get","delete","DATA_KEY","normalizeArguments","events","selector","handler","eventsObject","_i","_Object$keys","Object","keys","length","_step","_iterator","_createForOfIteratorHelper","split","s","n","done","err","e","f","parseEventNameAndNS","eventNameAndNS","supportMouseInput","Events","getEventsNS","ns","arguments","undefined","eventsNS","_i2","_Object$keys2","join","concat","off","_normalizeArguments2","_slicedToArray","_loop","_Object$keys3","_i3","v","_step2","_parseEventNameAndNS2","eventName","eventNS","handlersToDelete","_iterator2","_step2$value","handlerStorage","eventHandlers","filter","eventHandler","keep","removeEventListener","realHandler","Boolean","push","_i4","_handlersToDelete","_ret","_typeof","on","_normalizeArguments4","_loop2","_Object$keys4","_i5","_parseEventNameAndNS4","test","event","target","matches","contains","call","closest","addEventListener","trigger","data","CustomEvent","bubbles","cancelable","detail","dispatchEvent","Helpers","getComputedStyle","getWindow","getDocument","ownerDocument","window","document","getHeight","_getDimensions","getViewportHeight","_getViewportDimensions","getViewportWidth","getWidth","defaultView","height","elementStyle","style","oldStyle","display","position","visibility","getBoundingClientRect","_window","visualViewport","name","documentElement","value2","Math","min","Query","querySelector","getAll","_toConsumableArray","querySelectorAll","matchFunction","parentElement","parentsUntil","parents","parent","EVENTS_NS","supportPointerEvents","PointerEvent","MouseInputDetect","disable","enable","callbackOnFirstDetection","isFirstDetection","lastMove","mousemove","thisMove","x","pageX","y","pageY","timeStamp","Date","now","deltaX","abs","deltaY","pointerType","DEFAULTS","collapsibleActivateSelectedLinkOnInit","collapsibleBehaviorAccordion","collapsibleResetSubsOnClickOn","dropdownsShowTrigger","dropdownsShowTimeout","dropdownsHideTrigger","dropdownsHideTimeout","dropdownsDropReverseX","dropdownsDropReverseY","dropdownsNavSubOffsetX","dropdownsNavSubOffsetY","dropdownsSubSubOffsetX","dropdownsSubSubOffsetY","dropdownsKeepInViewport","markCurrentLinkAsSelectedOnInit","markCurrentLinkParentsAsSelected","resetTogglerOnLinkSelect","showSubOnSplitLinkSelect","classNavbarVertical","classNavbarDropReverseY","classNavbarDropReverseX","classSubMega","classLinkExpanded","classLinkSelected","classLinkDisabled","classLinkHasSub","classShow","classShowing","classHiding","selectorTogglerState","selectorTogglerAnchorShow","selectorTogglerAnchorHide","selectorCollapse","selectorOffcanvas","selectorOffcanvasOverlay","selectorNav","selectorSub","selectorItem","selectorLink","selectorLinkSplit","DATA_SUFFIX","DATA_ATTRIBUTE_PREFIX","API_EVENTS_SUFFIX","navbars","SmartMenus","options","_classCallCheck","this","_navbar","dataOptions","dataValue","dataset","charAt","toUpperCase","slice","Number","parseFloat","_opts","_objectSpread","_togglerState","_togglerAnchorShow","_togglerAnchorHide","_collapse","_offcanvas","_offcanvasOverlay","_nav","_navbarId","String","random","replace","_accessIdPrefix","_visibleSubs","_dropdownsShowTimeout","_dropdownsHideTimeout","_clickActivated","_zIndexInc","_idInc","_disabled","_wasCollapsible","_firstLink","_firstSub","_init","refresh","subHideAll","_destroySubs","_destroyNav","_destroyNavbar","hideSubs","showSub","menu","level","sub","_subIsVisible","reverse","linkActivate","_isCollapsible","_subHideSubs","_subHide","defaultPrevented","_subShow","destroy","_clearTimeout","visibleCount","selectedLink","pop","classAnimate","offsetWidth","classList","add","animationDuration","startsWith","endTimeout","clearTimeout","endTrigger","setTimeout","remove","setProperty","_animate","timeout","getAttribute","removeAttribute","splice","indexOf","_subResetPosition","_step3","_iterator3","_destroySub","_step4","_iterator4","link","_destroyLink","isCollapsible","_this","_lastTouch","x2","x1","y2","y1","_docClick","touchPoint","touches","zIndex","parseInt","isNaN","_isCSSOn","_initNavbar","_initNav","_initSubs","_markCurrentLinkAsSelected","_activateSelectedLink","some","object","_linkEnter","_navOver","bind","_navOut","keydown","_navKeyDown","mouseenter","mouseleave","_linkLeave","mousedown","_linkDown","focus","_linkFocus","blur","_linkBlur","click","_linkClick","setAttribute","_togglerAnchorShowClick","_togglerAnchorHideClick","_offcanvasOverlayClick","parentLink","parentLinkNextElement","nextElementSibling","parentLinkToggler","_setTogglerSubARIA","touchstart","_docTouchStart","touchmove","_docTouchMove","touchend","_docTouchEnd","_winResize","_step5","subs","_iterator5","_initSub","_handleEvents","preventDefault","isTogglerClicked","linkToggler","subIsVisible","selectLink","_this2","_isTouchMode","keyCode","closestSub","_this3","type","relatedTarget","_step6","reDefaultDocument","locHref","location","href","locHrefNoHash","_iterator6","_step7","_iterator7","togglerElement","subElement","togglerId","subId","_animateHide","index","parentItem","mega","vertical","horizontalParent","rtl","direction","rightToLeft","downToUp","xProperty","xPropertyCapitalized","yProperty","yPropertyCapitalized","parentItemRect","parentItemRectX","parentItemRectY","parentItemWidth","parentItemHeight","subComputedStyle","subOffsetX","subOffsetY","positionedParent","positionedParentRect","positionedParentComputedStyle","viewportWidth","viewportHeight","subWidth","subHeight","parentItemX","parentItemY","_getRootZIndex","top","left","bottom","right","_subPosition","_animateShow","hash","RegExp","_navbars"],"mappings":";;;;;;ksGAOA,IAAMA,EAAU,IAAIC,QAEdC,EAAO,CACXC,aAAIC,EAASC,EAAKC,GACXN,EAAQO,IAAIH,IACfJ,EAAQG,IAAIC,EAAS,IAAII,KAG3BR,EAAQS,IAAIL,GAASD,IAAIE,EAAKC,IAGhCG,aAAIL,EAASC,GACX,OAAOL,EAAQO,IAAIH,IAAYJ,EAAQS,IAAIL,GAASK,IAAIJ,IAAgB,MAG1EK,gBAAON,EAASC,GACd,QAAIL,EAAQO,IAAIH,IACPJ,EAAQS,IAAIL,GAASM,OAAOL,KCfnCM,EAAW,YAEjB,SAASC,EAAmBC,EAAQC,EAAUC,GAM5C,GALKA,GAA+B,mBAAbD,IACrBC,EAAUD,EACVA,EAAW,KAGRD,GAA4B,iBAAXA,EAAqB,CACzC,IAAMG,EAAe,GACrBA,EAAaH,GAAU,IAAME,EAC7BF,EAASG,EAGNF,IACHA,EAAW,IAKb,IADA,IAAME,EAAe,GACrBC,IAAAC,EAAkBC,OAAOC,KAAKP,GAAOI,EAAAC,EAAAG,OAAAJ,IAAE,CAAlC,IAC+BK,EADzBjB,EAAGa,EAAAD,GAAAM,EAAAC,EACQnB,EAAIoB,MAAM,MAAI,IAAlC,IAAAF,EAAAG,MAAAJ,EAAAC,EAAAI,KAAAC,MAAoC,CAClCZ,EADcM,EAAAhB,OACQO,EAAOR,UAC9BwB,GAAAN,EAAAO,EAAAD,WAAAN,EAAAQ,KAKH,MAAO,CAFPlB,EAASG,EAEOF,EAClB,CAEA,SAASkB,EAAoB1B,GAC3B,IAAM2B,EAAiB3B,EAAMmB,MAAM,KACnC,MAAO,CAACQ,EAAe,GAAIA,EAAe,IAAM,GAClD,CAEA,ICjCIC,EDiCEC,EAAS,CAEbC,qBAAYvB,GAEV,IAF2B,IAATwB,EAAEC,UAAAjB,eAAAkB,IAAAD,aAAAA,aAAG,GACjBE,EAAW,GACjBC,IAAAC,EAAkBvB,OAAOC,KAAKP,GAAO4B,EAAAC,EAAArB,OAAAoB,IAAE,CAAlC,IAAMpC,EAAGqC,EAAAD,GACZD,EAASnC,EAAIoB,MAAM,KAAKkB,QAAIC,OAAIP,QAASA,GAAMxB,EAAOR,GAGxD,OAAOmC,GAGTK,aAAIzC,EAASS,EAAQC,EAAUC,GAC7B,IAAMf,EAAUE,EAAKO,IAAIL,EAASO,GAClC,GAAKX,EAAL,CAEC,IAEiE8C,EAAAC,EAA7CnC,EAAmBC,EAAQC,EAAUC,MAAzDF,EAAMiC,KAAEhC,EAAQgC,KAEjB,IAFiB,IAAAE,aAEZ,IAAM3C,EAAG4C,EAAAC,GACNnC,EAAUF,EAAOR,GACvB,GAAIU,IAAYf,EAAQO,IAAIQ,GAC1B,OAAAoC,UACD,IAMsDC,EAJFC,EAAAN,EAAxBf,EAAoB3B,MAA1CiD,EAASD,KAAEE,EAAOF,KACnBG,EAAmB,GAC+DC,EAAAjC,EAAhET,GAAU,IAAIP,KAAML,IAAIY,EAASf,EAAQS,IAAIM,IAAYf,GAE1B,IAAvD,IAAAyD,EAAA/B,MAAA0B,EAAAK,EAAA9B,KAAAC,MAAyD,CAAA,IAAA8B,EAAAX,EAAAK,EAAA9C,SAA7CS,EAAO2C,KAAEC,EAAcD,KACjCC,EAAeC,cAAgBD,EAAeC,cAAcC,QAAO,SAAAC,GACjE,IAAIC,GAAO,EAaX,OAZIT,EACFS,KAAST,IAAcQ,EAAaR,WAAeC,GAAWA,IAAYO,EAAaP,SAAczC,GAAYA,IAAagD,EAAahD,UAClIyC,EACTQ,IAASR,IAAYO,EAAaP,WAAazC,GAAYA,IAAagD,EAAahD,WAC5EA,IACTiD,EAAOjD,IAAagD,EAAahD,UAG9BiD,GACH3D,EAAQ4D,oBAAoBF,EAAaR,UAAWQ,EAAaG,YAAaC,QAAQJ,EAAahD,WAG9FiD,KAEmC,IAAxCJ,EAAeC,cAAcvC,QAC/BmC,EAAiBW,KAAKpD,UAEzBc,GAAA4B,EAAA3B,EAAAD,WAAA4B,EAAA1B,IAED,QAAAqC,IAAAC,EAAsBb,EAAgBY,EAAAC,EAAAhD,OAAA+C,IAAE,CAAnC,IAAMrD,EAAOsD,EAAAD,GAChBpE,EAAQU,OAAOK,KAjCnBmC,IAAAD,EAAkB9B,OAAOC,KAAKP,GAAOqC,EAAAD,EAAA5B,OAAA6B,IAAE,CAAA,IAAAoB,EAAAtB,IAAA,cAAAuB,EAAAD,UAAAA,EAAAnB,KAsCzCqB,YAAGpE,EAASS,EAAQC,EAAUC,GAC5B,IAAIf,EAAUE,EAAKO,IAAIL,EAASO,GAC3BX,IACHA,EAAU,IAAIQ,IACdN,EAAKC,IAAIC,EAASO,EAAUX,IAC7B,IAEiEyE,EAAA1B,EAA7CnC,EAAmBC,EAAQC,EAAUC,MAAzDF,EAAM4D,KAAE3D,EAAQ2D,KAEjB,IAFiB,IAAAC,aAEZ,IAAMrE,EAAGsE,EAAAC,GACN7D,EAAUF,EAAOR,GAC8BwE,EAAA9B,EAAxBf,EAAoB3B,MAA1CiD,EAASuB,KAAEtB,EAAOsB,KACnBZ,EAAcnD,EACf,uBAAuBgE,KAAKxB,GAC3B,SAAUyB,GAAO,IACTC,EAAWD,EAAXC,OACJA,GAAUA,EAAOC,SAAWD,EAAOC,QAAQnE,IAAaV,EAAQ8E,SAASF,IAC3EjE,EAAQoE,KAAKH,EAAQD,EAAOC,IAG9B,SAAUD,GAAO,IACTC,EAAWD,EAAXC,OACFI,EAAUJ,GAAUA,EAAOI,SAAWJ,EAAOI,QAAQtE,GACvDsE,GAAWhF,EAAQ8E,SAASE,IAC9BrE,EAAQoE,KAAKC,EAASL,EAAOK,IAGjC,SAAUL,GACVhE,EAAQoE,KAAK/E,EAAS2E,EAAO3E,IAG5BJ,EAAQO,IAAIQ,IACff,EAAQG,IAAIY,EAAS,CAAE6C,cAAe,KAGjB5D,EAAQS,IAAIM,GACpB6C,cAAcO,KAAK,CAChCb,UAAAA,EACAC,QAAAA,EACAzC,SAAAA,EACAmD,YAAAA,IAEF7D,EAAQiF,iBAAiB/B,EAAWW,EAAaC,QAAQpD,KAjC3D8D,IAAAD,EAAkBxD,OAAOC,KAAKP,GAAO+D,EAAAD,EAAAtD,OAAAuD,IAAEF,KAqCzCY,iBAAQlF,EAASkD,EAAWiC,GAC1B,IAAMR,EAAQ,IAAIS,YAAYlC,EAAW,CAAEmC,SAAS,EAAMC,YAAY,EAAMC,OAAQJ,GAAQ,OAE5F,OADAnF,EAAQwF,cAAcb,GACfA,IEhJLc,EAAU,CACdC,0BAAiB1F,GACf,OAAOyF,EAAQE,UAAU3F,GAAS0F,iBAAiB1F,IAGrD4F,qBAAY5F,GACV,OAAQA,GAAWA,EAAQ6F,eAAkBC,OAAOC,UAGtDC,mBAAUhG,GACR,OAAOyF,EAAQQ,eAAejG,GAAS,IAGzCkG,2BAAkBlG,GAChB,OAAOyF,EAAQU,uBAAuBnG,GAAS,IAGjDoG,0BAAiBpG,GACf,OAAOyF,EAAQU,uBAAuBnG,IAGxCqG,kBAASrG,GACP,OAAOyF,EAAQQ,eAAejG,IAGhC2F,mBAAU3F,GACR,IAAM6F,EAAgB7F,GAAWA,EAAQ6F,cACzC,OAAQA,GAAiBA,EAAcS,aAAgBR,QAGzDG,wBAAejG,EAASuG,GACtB,IAAMC,EAAexG,EAAQyG,MACzBC,EAAW,KACmC,SAA9CjB,EAAQC,iBAAiB1F,GAAS2G,UACpCD,EAAW,CAAEE,SAAUJ,EAAaI,SAAUC,WAAYL,EAAaK,WAAYF,QAASH,EAAaG,SACzGH,EAAaI,SAAW,WACxBJ,EAAaK,WAAa,SAC1BL,EAAaG,QAAU,SAGzB,IAAMzG,EAAQF,EAAQ8G,wBAAwBP,EAAS,SAAW,SAOlE,OANIG,IACFF,EAAaG,QAAUD,EAASC,QAChCH,EAAaI,SAAWF,EAASE,SACjCJ,EAAaK,WAAaH,EAASG,YAG9B3G,GAGTiG,gCAAuBnG,EAASuG,GAC9B,IAAMQ,EAAUtB,EAAQE,UAAU3F,GAC1BgH,EAAmBD,EAAnBC,eACR,GAAIA,EACF,OAAOA,EAAeT,EAAS,SAAW,SAG5C,IACMU,EAAOV,EAAS,SAAW,QAC3BrG,EAFYuF,EAAQG,YAAY5F,GAEdkH,yBAAe1E,OAAUyE,IAC3CE,EAASJ,UAAOvE,OAASyE,IAC/B,OAAOE,EAASC,KAAKC,IAAInH,EAAOiH,GAAUjH,IC7DxCoH,EAAQ,CACZjH,aAAIK,GAA8C,IAApCV,EAAOkC,UAAAjB,eAAAkB,IAAAD,aAAAA,aAAG6D,SAASmB,gBAC/B,OAAOlH,EAAQuH,cAAc7G,IAG/B8G,gBAAO9G,GAA8C,IAApCV,EAAOkC,UAAAjB,eAAAkB,IAAAD,aAAAA,aAAG6D,SAASmB,gBAClC,OAAAO,EAAWzH,EAAQ0H,iBAAiBhH,KAGtCsE,iBAAQhF,EAAS2H,GAGf,IAFA,IAAI3C,EAAU,KAEPhF,GAAS,CACd,GAAI2H,EAAc3H,GAAU,CAC1BgF,EAAUhF,EACV,MAGFA,EAAUA,EAAQ4H,cAGpB,OAAO5C,GAGT6C,sBAAa7H,EAASU,EAAU+C,GAI9B,IAHA,IAAMqE,EAAU,GACZC,EAAS/H,EAAQ4H,cAEdG,IAAWA,EAAOlD,QAAQnE,IAC1B+C,IAAUsE,EAAOlD,QAAQpB,IAC5BqE,EAAQ/D,KAAKgE,GAGfA,EAASA,EAAOH,cAGlB,OAAOE,IFjCLE,MAASxF,OADE,YAIXyF,EAAyC,oBAAXnC,QAAiChC,QAAQgC,OAAOoC,cAE9EC,EAAmB,CACnBrG,wBACF,OAAOA,GAGTsG,wBAC4BjG,IAAtBL,IACFC,EAAOU,IAAIsD,SAAUiC,GACrBlG,OAAoBK,IAIxBkG,gBAAOC,GACL,QAA0BnG,IAAtBL,EAAiC,CACnCA,GAAoB,EAGpB,IAAIyG,GAAmB,EACnBC,EAAW,KACT/H,EAAS,CACbgI,mBAAU9D,GACR,IAAM+D,EAAW,CAAEC,EAAGhE,EAAMiE,MAAOC,EAAGlE,EAAMmE,MAAOC,UAAWC,KAAKC,OACnE,GAAIT,EAAU,CACZ,IAAMU,EAAS9B,KAAK+B,IAAIX,EAASG,EAAID,EAASC,GACxCS,EAAShC,KAAK+B,IAAIX,EAASK,EAAIH,EAASG,IACzCK,EAAS,GAAKE,EAAS,IAAMF,GAAU,GAAKE,GAAU,GAAKV,EAASK,UAAYP,EAASO,WAAa,MACzGjH,GAAoB,EAChByG,IACED,GACFA,EAAyB3D,GAG3B4D,GAAmB,IAKzBC,EAAWE,IAIfjI,EAAOwH,EAAuB,qCAAuC,cAAgB,SAAAtD,GAC9E,cAAcD,KAAKC,EAAM0E,eAC5BvH,GAAoB,IAIxBC,EAAOqC,GAAG2B,SAAUhE,EAAOC,YAAYvB,EAAQuH,OGvD/CsB,EAAW,CACfC,uCAAuC,EACvCC,8BAA8B,EAC9BC,8BAA+B,UAC/BC,qBAAsB,QACtBC,qBAAsB,IACtBC,qBAAsB,QACtBC,qBAAsB,IACtBC,uBAAuB,EACvBC,uBAAuB,EACvBC,uBAAwB,EACxBC,uBAAwB,EACxBC,uBAAwB,EACxBC,uBAAwB,EACxBC,yBAAyB,EACzBC,iCAAiC,EACjCC,kCAAkC,EAClCC,0BAA0B,EAC1BC,0BAA0B,EAC1BC,oBAAqB,sBACrBC,wBAAyB,4BACzBC,wBAAyB,4BACzBC,aAAc,eACdC,kBAAmB,cACnBC,kBAAmB,cACnBC,kBAAmB,cACnBC,gBAAiB,aACjBC,UAAW,UACXC,aAAc,aACdC,YAAa,YACbC,qBAAsB,oBACtBC,0BAA2B,2BAC3BC,0BAA2B,2BAC3BC,iBAAkB,eAClBC,kBAAmB,gBACnBC,yBAA0B,wBAC1BC,YAAa,UACbC,YAAa,UACbC,aAAc,6BACdC,aAAc,6BACdC,kBAAmB,4CCjCfvL,EAAW,KACXwL,MAAWvJ,OAAOjC,GAClByL,UAAqBxJ,OAAWjC,OAChCyH,MAASxF,OAAOjC,GAChB0L,MAAiBzJ,OAAOjC,GAExB2L,EAAU,GAEVC,aACJ,SAAAA,EAAYnM,EAASoM,gGAASC,MAAAF,GAC5BG,KAAKC,QAAUvM,EAIf,IADA,IAAMwM,EAAc,GACpB3L,IAAAC,EAAkBC,OAAOC,KAAKsI,GAASzI,EAAAC,EAAAG,OAAAJ,IAAE,CAApC,IAAMZ,EAAGa,EAAAD,GACR4L,EAAYH,KAAKC,QAAQG,WAAOlK,OAAIjC,GAAQiC,OAAGvC,EAAI0M,OAAO,GAAGC,eAAapK,OAAGvC,EAAI4M,MAAM,KAC3F,QAAkB1K,IAAdsK,EAAyB,CAC3B,OAAAtI,EAAemF,EAASrJ,KACtB,IAAK,SACHwM,EAAYK,OAAOC,WAAWN,EAAW,IACzC,MAGF,IAAK,UACHA,EAA0B,SAAdA,EAKhBD,EAAYvM,GAAOwM,GAIvBH,KAAKU,MAAKC,EAAAA,EAAAA,KAAQ3D,GAAa8C,GAAYI,GAC3CF,KAAKY,cAAgB,KACrBZ,KAAKa,mBAAqB,KAC1Bb,KAAKc,mBAAqB,KAC1Bd,KAAKe,UAAY,KACjBf,KAAKgB,WAAa,KAClBhB,KAAKiB,kBAAoB,KACzBjB,KAAKkB,KAAO,KACZlB,KAAKmB,UAAYC,OAAO1E,KAAKC,MAAQ7B,KAAKuG,UAAUC,QAAQ,MAAO,IACnEtB,KAAKuB,mBAAerL,OAAMjC,OAAQiC,OAAI8J,KAAKmB,eAC3CnB,KAAKwB,aAAe,GACpBxB,KAAKyB,sBAAwB,EAC7BzB,KAAK0B,sBAAwB,EAC7B1B,KAAK2B,iBAAkB,EACvB3B,KAAK4B,WAAa,EAClB5B,KAAK6B,OAAS,EACd7B,KAAK8B,WAAY,EACjB9B,KAAK+B,iBAAkB,EAGvB/B,KAAKgC,WAAa,KAClBhC,KAAKiC,UAAY,KAEjBjC,KAAKkC,kBAkBN,SAfDrC,MAAAlM,cAiBAC,eACQuO,GACNnC,KAAKoC,aAEDpC,KAAKkB,OACPlB,KAAKqC,eACLrC,KAAKsC,cACLtC,KAAKkB,KAAO,MAGdlB,KAAKY,cAAgB,KACjBZ,KAAKa,qBACPrN,EAAKQ,OAAOgM,KAAKa,2CAAkB3K,OAA0BuJ,IAC7DO,KAAKa,mBAAqB,MAG5Bb,KAAKc,mBAAqB,KAC1Bd,KAAKe,UAAY,KACjBf,KAAKgB,WAAa,KAClBhB,KAAKiB,kBAAoB,KACzBjB,KAAKgC,WAAa,KAClBhC,KAAKiC,UAAY,KAEZE,IACHnC,KAAKuC,iBACLvC,KAAKC,QAAU,SAElBtM,cAAAC,iBAGMoM,KAAK8B,YACR9B,KAAKoC,aACLpC,KAAK8B,WAAY,MAEpBnO,aAAAC,iBAGKoM,KAAK8B,YACP9B,KAAK8B,WAAY,MAIrBnO,mBAAAC,eAQaF,GAA4C,IAAnC8O,EAAQ5M,UAAAjB,eAAAkB,IAAAD,aAAAA,aAAG,OAAQ6M,IAAO7M,UAAAjB,eAAAkB,IAAAD,eAAAA,aACxC8M,EAAOhP,EAAQgF,WAAOxC,OAAI8J,KAAKU,MAAMtB,kBAAWlJ,OAAK8J,KAAKU,MAAMrB,cAChEsD,EAAQnP,EAAKO,IAAI2O,UAAIxM,OAAUuJ,IAC/BmD,EAAMpP,EAAKO,IAAIL,QAAOwC,OAAQuJ,IAGpC,GAAIkD,EAAQ,IAAM3C,KAAK6C,cAAcH,GAAO,CAC1C,IAAMlH,EAAUR,EAAMO,aAAamH,EAAM1C,KAAKU,MAAMtB,YAAaY,KAAKU,MAAMrB,aAAayD,UACzFtH,EAAQ/D,KAAKiL,GAAK,IACQ9N,EADRC,EAAAC,EACC0G,GAAO,IAA1B,IAAA3G,EAAAG,MAAAJ,EAAAC,EAAAI,KAAAC,MAA4B,CAAA,IAAjBwN,EAAI9N,EAAAhB,MACboM,KAAK+C,aAAavP,EAAKO,IAAI2O,gBAAIxM,OAAgBuJ,IAAgBO,KAAKgD,mBAAqBhD,KAAKU,MAAMxD,6BAA+B,OAAS,eAC7I/H,GAAAN,EAAAO,EAAAD,WAAAN,EAAAQ,KAIH,OAAQmN,GACN,IAAK,OACHxC,KAAKiD,aAAaN,EAAQ,GAC1B,MAGF,IAAK,SACH3C,KAAKiD,aAAaN,GAClB,MAGF,IAAK,OACCC,GACF5C,KAAKkD,SAASN,IAOhBnN,EAAOmD,QAAQoH,KAAKC,mBAAO/J,OAAayJ,GAAqBjM,GAASyP,kBAAqBV,GAK3FG,GACF5C,KAAKoD,SAASR,MAEjBjP,cAAAC,iBAGCoM,KAAKqD,SAAQ,GACbrD,KAAKkC,OAAM,MACZvO,iBAAAC,iBAGCoM,KAAKsD,cAActD,KAAKyB,uBACxBzB,KAAKsD,cAActD,KAAK0B,uBAExB,IAAM6B,EAAevD,KAAKwB,aAAa7M,OAEvC,GAAI4O,EAAe,EAAG,CAAA,IAC8B7M,EAD9BK,EAAAjC,EACFqG,EAAI6E,KAAKwB,cAAcsB,WAAS,IAAlD,IAAA/L,EAAA/B,MAAA0B,EAAAK,EAAA9B,KAAAC,MAAoD,CAAA,IAAzC0N,EAAGlM,EAAA9C,MACZoM,KAAKkD,SAASN,UACfzN,GAAA4B,EAAA3B,EAAAD,WAAA4B,EAAA1B,KAGH2K,KAAKwB,aAAe,GACpBxB,KAAK2B,iBAAkB,EACvB3B,KAAK4B,WAAa,EAEd2B,EAAe,GACjB9N,EAAOmD,QAAQoH,KAAKC,kBAAO/J,OAAYyJ,OAI3ChM,4BAAAC,iBAEE,IAAM4P,EAAexI,EAAME,WAAMhF,OAAK8J,KAAKU,MAAMlC,mBAAqBwB,KAAKkB,MAAMuC,MAC7ED,GACFxD,KAAK+C,aAAaS,MAErB7P,eAAAC,eAEQF,EAASgQ,GAEXhQ,EAAQiQ,YAEbjQ,EAAQkQ,UAAUC,IAAIH,GAAa,IAC3BI,EAAsB3K,EAAQC,iBAAiB1F,GAA/CoQ,kBACR,GAAKA,IAAqBA,EAAkBC,WAAW,MAAvD,CAMA,IAAMC,EAAaxQ,EAAKO,IAAIL,yBAAOwC,OAAyBuJ,IACxDuE,IACFxK,OAAOyK,aAAaD,GACpBxQ,EAAKO,IAAIL,yBAAOwC,OAAyBuJ,GAAzCjM,IAGF,IAAM0Q,EAAa,WACjB1Q,EAAKQ,OAAON,yBAAOwC,OAAyBuJ,IAC5CjM,EAAKQ,OAAON,yBAAOwC,OAAyBuJ,IACxC/L,EAAQkQ,UAAUpL,SAASkL,IAC7BjO,EAAOmD,QAAQlF,EAAS,iBAI5BF,EAAKC,IAAIC,yBAAOwC,OAAyBuJ,GAAeyE,GACxD1Q,EAAKC,IAAIC,yBAAOwC,OAAyBuJ,GAAejG,OAAO2K,WAAWD,EAAoD,IAAvC1D,OAAOC,WAAWqD,GAA6B,IAGtIrO,EAAOqC,GAAGpE,iBAAOwC,OAAiBwF,IAAa,SAAArD,GACzCA,EAAMC,SAAW5E,IACnB+B,EAAOU,IAAIzC,iBAAOwC,OAAiBwF,IACnChI,EAAQkQ,UAAUQ,OAAOV,YA1B3BhQ,EAAQkQ,UAAUQ,OAAOV,MA6B5B/P,mBAAAC,eAEYF,GAEXA,EAAQyG,MAAMkK,iBAAWnO,OAAMjC,gBAAQiC,OAAciD,EAAQO,UAAUhG,UACvEA,EAAQkQ,UAAUQ,OAAOpE,KAAKU,MAAM/B,WACpCqB,KAAKsE,SAAS5Q,EAASsM,KAAKU,MAAM7B,gBACnClL,mBAAAC,eAEYF,GAEXA,EAAQyG,MAAMkK,iBAAWnO,OAAMjC,gBAAQiC,OAAciD,EAAQO,UAAUhG,UACvEA,EAAQkQ,UAAUC,IAAI7D,KAAKU,MAAM/B,WACjCqB,KAAKsE,SAAS5Q,EAASsM,KAAKU,MAAM9B,iBACnCjL,oBAAAC,eAEa2Q,GACRA,IACF/K,OAAOyK,aAAaM,GACpBA,EAAU,MAEb5Q,mBAAAC,eAEYF,GACPA,EAAQkQ,UAAUpL,SAASwH,KAAKU,MAAMhC,oBACnChL,EAAQ8Q,aAAa,OAAS,IAAIT,WAAW/D,KAAKuB,kBACrD7N,EAAQ+Q,gBAAgB,MAG1B/Q,EAAQkQ,UAAUQ,OAAOpE,KAAKU,MAAMhC,iBACpClL,EAAKQ,OAAON,QAAOwC,OAAQuJ,IAC3BjM,EAAKQ,OAAON,YAAOwC,OAAYuJ,IAC/BjM,EAAKQ,OAAON,SAAOwC,OAASuJ,IAC5B/L,EAAQ+Q,gBAAgB,QACxB/Q,EAAQ+Q,gBAAgB,iBACxB/Q,EAAQ+Q,gBAAgB,kBAGtBzE,KAAKU,MAAM3C,iCAAmCrK,EAAQkQ,UAAUpL,SAASwH,KAAKU,MAAMlC,qBACtF9K,EAAQkQ,UAAUQ,OAAOpE,KAAKU,MAAMlC,mBACpC9K,EAAQ+Q,gBAAgB,oBAE3B9Q,kBAAAC,iBAGCJ,EAAKQ,OAAOgM,KAAKkB,aAAIhL,OAAUuJ,IAC/BhK,EAAOU,IAAI6J,KAAKkB,KAAMxF,GACtBjG,EAAOU,IAAIqD,OAAOC,YAAQvD,OAAKwF,OAASxF,OAAI8J,KAAKmB,YACjD1L,EAAOU,IAAIqD,UAAMtD,OAAKwF,OAASxF,OAAI8J,KAAKmB,eACzCxN,qBAAAC,iBAGCJ,EAAKQ,OAAOgM,KAAKC,QAAShM,GAC1B+L,KAAKC,QAAQwE,mBAAevO,OAAIwJ,SAChCjK,EAAOU,IAAI6J,KAAKC,QAASvE,GACzBkE,EAAQ8E,OAAO9E,EAAQ+E,QAAQ3E,MAAO,MACvCrM,kBAAAC,eAEWF,GACUF,EAAKO,IAAIL,iBAAOwC,OAAiBuJ,KAEnDO,KAAK4E,kBAAkBlR,IAGpBA,EAAQ8Q,aAAa,OAAS,IAAIT,WAAW/D,KAAKuB,kBACrD7N,EAAQ+Q,gBAAgB,MAG1BjR,EAAKQ,OAAON,iBAAOwC,OAAiBuJ,IACpCjM,EAAKQ,OAAON,gBAAOwC,OAAgBuJ,IACnCjM,EAAKQ,OAAON,UAAOwC,OAAUuJ,IAC7BjM,EAAKQ,OAAON,0BAAOwC,OAA0BuJ,IAC7C/L,EAAQ+Q,gBAAgB,eACxB/Q,EAAQ+Q,gBAAgB,sBACzB9Q,mBAAAC,iBAEc,IACoDiR,EADpDC,EAAAhQ,EACKkG,EAAME,OAAO8E,KAAKU,MAAMrB,YAAaW,KAAKkB,OAAK,IAAjE,IAAA4D,EAAA9P,MAAA6P,EAAAC,EAAA7P,KAAAC,MAAmE,CAAA,IAAxD0N,EAAGiC,EAAAjR,MACZoM,KAAK+E,YAAYnC,UAInBzN,GAAA2P,EAAA1P,EAAAD,WAAA2P,EAAAzP,IAAA,IACmE2P,EADnEC,EAAAnQ,EACmBkG,EAAME,OAAO8E,KAAKU,MAAMnB,aAAcS,KAAKkB,OAAK,IAAnE,IAAA+D,EAAAjQ,MAAAgQ,EAAAC,EAAAhQ,KAAAC,MAAqE,CAAA,IAA1DgQ,EAAIF,EAAApR,MACboM,KAAKmF,aAAaD,UACnB/P,GAAA8P,EAAA7P,EAAAD,WAAA8P,EAAA5P,QACF1B,gBAAAC,eAESyE,GAER,IAAM+M,EAAgBpF,KAAKgD,oBACpBoC,GAAqD,UAApCpF,KAAKU,MAAMpD,sBAAsC8H,GAA8D,SAA7CpF,KAAKU,MAAMvD,gCAAgD9E,EAAMC,QAAW0H,KAAKkB,KAAK1I,SAASH,EAAMC,SAC7L0H,KAAKoC,gBAERzO,mBAAAC,iBAEc,IAAAyR,OACb,GAAKrF,KAAKsF,WAAV,CAIA,UAA4BzP,IAAvBmK,KAAKsF,WAAWC,IAAoBvF,KAAKsF,WAAWE,KAAOxF,KAAKsF,WAAWC,SAA+B1P,IAAvBmK,KAAKsF,WAAWG,IAAoBzF,KAAKsF,WAAWI,KAAO1F,KAAKsF,WAAWG,IAAK,CACtKzF,KAAKsD,cAActD,KAAK0B,uBAExB,IACQpJ,EAAW0H,KAAKsF,WAAhBhN,OACR0H,KAAK0B,sBAAwBlI,OAAO2K,YAAW,WAC7CkB,EAAKM,UAAU,CAAErN,OAAAA,MAChB,KAGL0H,KAAKsF,WAAa,SACnB3R,oBAAAC,eAEayE,GACZ,GAAK2H,KAAKsF,WAAV,CAIA,IAAMM,EAAavN,EAAMwN,QAAQ,GACjC7F,KAAKsF,WAAWC,GAAKK,EAAWtJ,MAChC0D,KAAKsF,WAAWG,GAAKG,EAAWpJ,UACjC7I,qBAAAC,eAEcyE,GACb,IAAMuN,EAAavN,EAAMwN,QAAQ,GACjC7F,KAAKsF,WAAa,CAAEE,GAAII,EAAWtJ,MAAOoJ,GAAIE,EAAWpJ,MAAOlE,OAAQsN,EAAWtN,WACpF3E,qBAAAC,iBAGC,IAAMkS,EAAStF,OAAOuF,SAAS5M,EAAQC,iBAAiB4G,KAAKC,SAAS6F,OAAQ,IAC9E,OAAOtF,OAAOwF,MAAMF,GAAU,EAAIA,KACnCnS,oBAAAC,iBAGC,OAAQoM,KAAK8B,WAAa9B,KAAKiG,cAChCtS,YAAAC,eAEKuO,GAqBJ,GApBInC,KAAKC,QAAQ2D,UAAUpL,SAASwH,KAAKU,MAAMrC,2BAC7C2B,KAAKU,MAAMlD,uBAAwB,GAGjCwC,KAAKC,QAAQ2D,UAAUpL,SAASwH,KAAKU,MAAMtC,2BAC7C4B,KAAKU,MAAMjD,uBAAwB,GAGrCuC,KAAKY,cAAgB5F,EAAMjH,IAAIiM,KAAKU,MAAM5B,qBAAsBkB,KAAKC,SACrED,KAAKa,mBAAqB7F,EAAMjH,IAAIiM,KAAKU,MAAM3B,0BAA2BiB,KAAKC,SAC/ED,KAAKc,mBAAqB9F,EAAMjH,IAAIiM,KAAKU,MAAM1B,0BAA2BgB,KAAKC,SAC/ED,KAAKe,UAAY/F,EAAMjH,IAAIiM,KAAKU,MAAMzB,iBAAkBe,KAAKC,SAC7DD,KAAKgB,WAAahG,EAAMjH,IAAIiM,KAAKU,MAAMxB,kBAAmBc,KAAKC,SAC/DD,KAAKiB,kBAAoBjG,EAAMjH,IAAIiM,KAAKU,MAAMvB,yBAA0Ba,KAAKC,SAC7ED,KAAKkB,KAAOlG,EAAMjH,IAAIiM,KAAKU,MAAMtB,YAAaY,KAAKC,SAE9CkC,GACHnC,KAAKkG,cAGHlG,KAAKkB,KAAM,CACblB,KAAKmG,WACLnG,KAAKoG,YAGL,IAAMhB,EAAgBpF,KAAKgD,iBAC3BhD,KAAK+B,gBAAkBqD,EAEnBpF,KAAKU,MAAM3C,iCACbiC,KAAKqG,6BAGHrG,KAAKU,MAAMzD,uCAAyCmI,GACtDpF,KAAKsG,wBAGPzK,EAAiBE,QAEf,SAAA1D,GAAS,IACCC,EAAWD,EAAXC,OACJA,SAAAA,EAAQI,SACVkH,EAAQ2G,MAAK,SAAAC,GACX,IAAMtB,EAAO5M,EAAOI,QAAQ8N,EAAO9F,MAAMnB,cACzC,SAAI2F,IAAQsB,EAAOvG,QAAQzH,SAAS0M,KAClCsB,EAAOC,WAAWpO,EAAO6M,GAClB,cASpBvR,eAAAC,iBAGCJ,EAAKC,IAAIuM,KAAKkB,aAAIhL,OAAUuJ,GAAe,GAC3ChK,EAAOqC,GAAGkI,KAAKkB,KAAMzL,EAAOC,YAAY,CACtC,oBAAqBsK,KAAK0G,SAASC,KAAK3G,MACxC,oBAAqBA,KAAK4G,QAAQD,KAAK3G,MACvC6G,QAAS7G,KAAK8G,YAAYH,KAAK3G,OAC9BtE,IAEHjG,EAAOqC,GAAGkI,KAAKkB,KAAMzL,EAAOC,YAAY,CACtCqR,WAAY/G,KAAKyG,WAAWE,KAAK3G,MACjCgH,WAAYhH,KAAKiH,WAAWN,KAAK3G,MACjCkH,UAAWlH,KAAKmH,UAAUR,KAAK3G,MAC/BoH,MAAOpH,KAAKqH,WAAWV,KAAK3G,MAC5BsH,KAAMtH,KAAKuH,UAAUZ,KAAK3G,MAC1BwH,MAAOxH,KAAKyH,WAAWd,KAAK3G,OAC3BtE,GAAYsE,KAAKU,MAAMnB,iBAC3B5L,kBAAAC,iBAGCgM,EAAQnI,KAAKuI,MACbxM,EAAKC,IAAIuM,KAAKC,QAAShM,EAAU+L,MACjCA,KAAKC,QAAQyH,gBAAYxR,OAAIwJ,QAA2BM,KAAKmB,WAC7D1L,EAAOqC,GAAGkI,KAAKC,gBAAO/J,OAAUwF,GAAasE,KAAKU,MAAM3B,0BAA2BiB,KAAK2H,wBAAwBhB,KAAK3G,OACrHvK,EAAOqC,GAAGkI,KAAKC,gBAAO/J,OAAUwF,GAAasE,KAAKU,MAAM1B,0BAA2BgB,KAAK4H,wBAAwBjB,KAAK3G,OACrHvK,EAAOqC,GAAGkI,KAAKC,gBAAO/J,OAAUwF,GAAasE,KAAKU,MAAMvB,yBAA0Ba,KAAK6H,uBAAuBlB,KAAK3G,UACpHrM,eAAAC,eAEQF,GACP,IAAMoU,EAAa9M,EAAMjH,IAAIiM,KAAKU,MAAMnB,aAAc7L,EAAQgF,QAAQsH,KAAKU,MAAMpB,eACjFwI,EAAWlE,UAAUC,IAAI7D,KAAKU,MAAMhC,iBACpC,IAAMqJ,EAAwBD,EAAWE,mBACnCC,EAAoBF,SAAAA,EAAuBxP,QAAQyH,KAAKU,MAAMlB,oBAAsBsI,EAAWvP,QAAQyH,KAAKU,MAAMlB,mBAAqBuI,EAAwB,KACjKE,IACFzU,EAAKC,IAAIqU,YAAU5R,OAAYuJ,GAAewI,GAC9CzU,EAAKC,IAAIwU,SAAiB/R,OAASuJ,GAAeqI,GAClDG,EAAkBrE,UAAUC,IAAI7D,KAAKU,MAAMhC,kBAG7ClL,EAAKC,IAAIqU,QAAU5R,OAAQuJ,GAAe/L,GAC1CF,EAAKC,IAAIC,gBAAOwC,OAAgBuJ,GAAeqI,GAC/CtU,EAAKC,IAAIC,UAAOwC,OAAUuJ,GAAezE,EAAMO,aAAa7H,EAASsM,KAAKU,MAAMtB,YAAaY,KAAKU,MAAMrB,aAAa1K,OAAS,GAE9HqL,KAAKkI,mBAAmBD,GAAqBH,EAAYpU,MAC1DC,gBAAAC,iBAIyC,UAApCoM,KAAKU,MAAMpD,sBAAiF,SAA7C0C,KAAKU,MAAMvD,+BAC5D1H,EAAOqC,GAAG0B,OAAOC,SAAUhE,EAAOC,YAAY,CAC5CyS,WAAYnI,KAAKoI,eAAezB,KAAK3G,MACrCqI,UAAWrI,KAAKsI,cAAc3B,KAAK3G,MACnCuI,SAAUvI,KAAKwI,aAAa7B,KAAK3G,MACjCwH,MAAOxH,KAAK2F,UAAUgB,KAAK3G,UAC5B9J,OAAKwF,OAASxF,OAAI8J,KAAKmB,aAI1B1L,EAAOqC,GAAG0B,OAAQ/D,EAAOC,YAAY,CACnC,2BAA4BsK,KAAKyI,WAAW9B,KAAK3G,UAClD9J,OAAKwF,OAASxF,OAAI8J,KAAKmB,aAExB,IACsBuH,EADhBC,EAAO3N,EAAME,OAAO8E,KAAKU,MAAMrB,YAAaW,KAAKkB,MAAK0H,EAAA9T,EAC1C6T,GAAI,IAAtB,IAAAC,EAAA5T,MAAA0T,EAAAE,EAAA3T,KAAAC,MAAwB,CAAA,IAAb0N,EAAG8F,EAAA9U,MACZoM,KAAK6I,SAASjG,UAGhBzN,GAAAyT,EAAAxT,EAAAD,WAAAyT,EAAAvT,IACA2K,KAAKgC,WAAahH,EAAMjH,IAAIiM,KAAKU,MAAMnB,aAAcS,KAAKkB,MAC1DlB,KAAKiC,UAAY0G,EAAK,MACvBhV,qBAAAC,iBAGC,OAAOoM,KAAKiG,YAAcjG,KAAKiC,WAAmE,WAAtD9I,EAAQC,iBAAiB4G,KAAKiC,WAAW3H,YACtF3G,eAAAC,iBAGC,OAAOoM,KAAKgC,YAAoE,WAAtD7I,EAAQC,iBAAiB4G,KAAKgC,YAAY3H,WACrE1G,mBAAAC,iBAGC,OAAQiI,EAAiBrG,mBAAqBwK,KAAKgD,oBACpDrP,gBAAAC,eAESyE,EAAO3E,GACf,GAAKsM,KAAK8I,gBAAV,CAKA,IAAM5D,EAAO1R,EAAKO,IAAIL,SAAOwC,OAASuJ,IAClCyF,EACFlF,KAAKuH,UAAUlP,EAAO6M,GAIxBzP,EAAOmD,QAAQoH,KAAKC,eAAO/J,OAASyJ,GAAqBjM,OAI3DC,iBAAAC,eACWyE,EAAO3E,GAChB,GAAKsM,KAAK8I,gBAAV,CAIA,GAAIpV,EAAQkQ,UAAUpL,SAASwH,KAAKU,MAAMjC,mBAExC,OADApG,EAAM0Q,kBACC,EAIT,IAAI7D,EAAO1R,EAAKO,IAAIL,SAAOwC,OAASuJ,IAC9BuJ,EAAmBxR,QAAQ0N,GAKjC,GAJK8D,IACH9D,EAAOxR,GAGL+B,EAAOmD,QAAQoH,KAAKC,gBAAO/J,OAAUyJ,GAAqBuF,GAAM/B,iBAElE,OADA9K,EAAM0Q,kBACC,EAGT,IAAME,EAAczV,EAAKO,IAAImR,YAAIhP,OAAYuJ,IACvCmD,EAAMpP,EAAKO,IAAImR,QAAIhP,OAAQuJ,IAC3ByJ,EAAetG,GAAO5C,KAAK6C,cAAcD,GACzCD,EAAQnP,EAAKO,IAAI6O,UAAG1M,OAAUuJ,IAAiB,EAC/C2F,EAAgBpF,KAAKgD,iBACrBmG,GAAcvG,GAAQqG,IAAgBD,EAE5C,GAAIG,GAAc1T,EAAOmD,QAAQoH,KAAKC,iBAAO/J,OAAWyJ,GAAqBuF,GAAM/B,iBAEjF,OADA9K,EAAM0Q,kBACC,GAGLnG,GAASuG,IAAcnJ,KAAKU,MAAMxC,2BACpC8B,KAAK2B,gBAAkB3B,KAAK2B,iBAAmBnK,SAAS4N,IAAkB8D,GAAoD,yBAApClJ,KAAKU,MAAMtD,sBAA6D,IAAVuF,IAI1J,IAAIH,EAAW,QACX0G,IAAgB9D,GAAkBpF,KAAKU,MAAMxD,8BAAkCiM,GAAenJ,KAAKU,MAAMxC,2BAG1G0E,KAEIsG,GAAkB9D,IAAiBpF,KAAKU,MAAMxD,8BAAmCiM,GAAenJ,KAAKU,MAAMxC,4BACvGgL,GAAkB9D,KAAkBpF,KAAKU,MAAMxD,8BAAkCiM,IAAcnJ,KAAKU,MAAMxC,8BAG9G0E,GAAQwC,KAEb5C,EAAW,QAVXA,EAAW,OAab,IAAMC,EAAU0G,EAAanJ,KAAKU,MAAMxC,0BAA4BgL,EAIpE,OAHAlJ,KAAK+C,aAAamC,EAAM1C,EAAUC,GAG9B0G,GACEnJ,KAAKU,MAAMzC,0BAA4B+B,KAAKc,oBAAoF,SAA9D3H,EAAQC,iBAAiB4G,KAAKc,oBAAoBzG,SAAsB2F,KAAKc,mBAAmB6C,YAAc,GAClL3D,KAAKc,mBAAmB0G,QAGrBpC,GAAmBxC,IAAOsG,GAAiBlJ,KAAKU,MAAMxC,0BACzD8B,KAAKoC,cAGA,GAILQ,IACGwC,GAA2B,IAAVzC,GAAeuG,GACnClJ,KAAKoC,aAGP/J,EAAM0Q,kBACC,QANT,MASFpV,gBAAAC,eAEUyE,EAAO3E,GACf,GAAKsM,KAAK8I,gBAAV,CAKA,IAAM5D,EAAO1R,EAAKO,IAAIL,SAAOwC,OAASuJ,IAClCyF,EACFlF,KAAKmH,UAAU9O,EAAO6M,GAIxB1R,EAAKC,IAAIC,cAAOwC,OAAcuJ,IAAe,OAC9C9L,iBAAAC,eAEUyE,EAAO3E,GAAS,IAAA0V,OACzB,GAAKpJ,KAAK8I,gBAAV,CAKA,IAAM5D,EAAO1R,EAAKO,IAAIL,SAAOwC,OAASuJ,IACtC,GAAIyF,EACFlF,KAAKyG,WAAWpO,EAAO6M,OADzB,CAKA,IAAKlF,KAAKqJ,iBAAuD,cAApCrJ,KAAKU,MAAMtD,sBAA6E,yBAApC4C,KAAKU,MAAMtD,sBAAmD4C,KAAK2B,iBAAwD,UAApC3B,KAAKU,MAAMpD,sBAAmC,CACpN0C,KAAKsD,cAActD,KAAKyB,uBAExB,IAAMkB,EAAQnP,EAAKO,IAAIL,EAAQgF,WAAOxC,OAAI8J,KAAKU,MAAMtB,kBAAWlJ,OAAK8J,KAAKU,MAAMrB,sBAAcnJ,OAAUuJ,IAClGmD,EAAMpP,EAAKO,IAAIL,QAAOwC,OAAQuJ,IAC9B+C,EAAYI,GAAQ5C,KAAK6C,cAAcD,GAAgB,SAAT,OAC9CH,EAA8C,cAApCzC,KAAKU,MAAMtD,sBAA6E,yBAApC4C,KAAKU,MAAMtD,sBAAmD4C,KAAK2B,gBACjI4C,EAA8C,yBAApCvE,KAAKU,MAAMtD,sBAA6D,IAAVuF,EAAc,EAAI3C,KAAKU,MAAMrD,qBAC3G2C,KAAKyB,sBAAwBjI,OAAO2K,YAAW,WAC7CiF,EAAKrG,aAAarP,EAAS8O,EAAUC,KACpC8B,GAGL9O,EAAOmD,QAAQoH,KAAKC,qBAAO/J,OAAeyJ,GAAqBjM,QAChEC,iBAAAC,eAEUyE,EAAO3E,GAChB,GAAKsM,KAAK8I,gBAAV,CAKA,IAAM5D,EAAO1R,EAAKO,IAAIL,SAAOwC,OAASuJ,IACtC,GAAIyF,EACFlF,KAAKqH,WAAWhP,EAAO6M,OADzB,CAMA,IAAK1R,EAAKO,IAAIL,cAAOwC,OAAcuJ,IAAgB,CACjD,IAAMmD,EAAMpP,EAAKO,IAAIL,QAAOwC,OAAQuJ,IAC9B+C,EAAWxC,KAAKgD,mBAAqBhD,KAAKU,MAAMxD,6BAA+B,OAAW0F,GAAQ5C,KAAK6C,cAAcD,GAAgB,SAAT,OAElI5C,KAAK+C,aAAarP,EAAS8O,GADX,GAIlB/M,EAAOmD,QAAQoH,KAAKC,gBAAO/J,OAAUyJ,GAAqBjM,QAC3DC,iBAAAC,eAEUyE,EAAO3E,GAChB,GAAKsM,KAAK8I,gBAAV,CAKA,IAAM5D,EAAO1R,EAAKO,IAAIL,SAAOwC,OAASuJ,IACtC,GAAIyF,EACFlF,KAAKiH,WAAW5O,EAAO6M,OADzB,CAKA,IAAKlF,KAAKqJ,gBAAsD,UAApCrJ,KAAKU,MAAMpD,qBAAkC,CACvE5J,EAAQ4T,OACR,IAAM2B,EAAczV,EAAKO,IAAIL,YAAOwC,OAAYuJ,IAC5CwJ,GACFA,EAAY3B,OAGdtH,KAAKsD,cAActD,KAAKyB,uBAG1BjO,EAAKQ,OAAON,cAAOwC,OAAcuJ,IAEjChK,EAAOmD,QAAQoH,KAAKC,qBAAO/J,OAAeyJ,GAAqBjM,QAChEC,kBAAAC,eAEWyE,GACV,GAAK2H,KAAK8I,gBAIV,OAAQzQ,EAAMiR,SAEZ,KAAK,GAAI,IACChR,EAAWD,EAAXC,OAER,GAAIA,SAAAA,EAAQC,QAAQyH,KAAKU,MAAMnB,cAAe,CAC5C,IAAM2F,EAAO1R,EAAKO,IAAIuE,SAAMpC,OAASuJ,KAAkBnH,EAEjD5E,EADcF,EAAKO,IAAImR,YAAIhP,OAAYuJ,KACdyF,EACzBtC,EAAMpP,EAAKO,IAAImR,QAAIhP,OAAQuJ,IACjC,GAAImD,GAAO5C,KAAK6C,cAAcD,GAG5B,OAFA5C,KAAKyH,WAAWpP,EAAO3E,QACvB2E,EAAM0Q,iBAMV,IAAMQ,EAAajR,eAAAA,EAAQI,WAAOxC,OAAI8J,KAAKU,MAAMrB,cACjD,GAAIkK,EAAY,CACd,IAAMzB,EAAatU,EAAKO,IAAIwV,gBAAUrT,OAAgBuJ,IAEhD/L,EADoBF,EAAKO,IAAI+T,YAAU5R,OAAYuJ,KACpBqI,EACrC9H,KAAKyH,WAAWpP,EAAO3E,GACvBA,EAAQ0T,QACR/O,EAAM0Q,iBAGR,OAIF,KAAK,GAAI,IACCzQ,EAAWD,EAAXC,OAEJA,SAAAA,EAAQC,QAAQyH,KAAKU,MAAMnB,gBAC7BS,KAAKyH,WAAWpP,EAAOC,GACvBD,EAAM0Q,sBAIbpV,cAAAC,eAEOyE,GAAO,IAAAmR,OACRxJ,KAAK8I,kBAAmB9I,KAAKqJ,gBAAkBhR,EAAMC,SAAW0H,KAAKkB,OAI1ElB,KAAKsD,cAActD,KAAK0B,uBAGgB,UAApC1B,KAAKU,MAAMpD,uBAAoD,aAAfjF,EAAMoR,OAAuBpR,EAAMqR,eAAmBrR,EAAMC,QAAW0H,KAAKkB,KAAK1I,SAASH,EAAMC,WAClJ0H,KAAK0B,sBAAwBlI,OAAO2K,YAAW,WAC7CqF,EAAKpH,eACJpC,KAAKU,MAAMnD,2BAEjB5J,eAAAC,eAEQyE,GACF2H,KAAK8I,kBAAmB9I,KAAKqJ,gBAAkBhR,EAAMC,SAAW0H,KAAKkB,MAI1ElB,KAAKsD,cAActD,KAAK0B,0BACzB/N,6BAAAC,eAEsByE,GAChB2H,KAAK8I,kBAIN9I,KAAKc,oBACPd,KAAKc,mBAAmB0G,QAG1BnP,EAAM0Q,qBACPpV,iCAAAC,iBAGC,IAImE+V,EAJ7DC,EAAoB,4BAEpBC,EAAUrQ,OAAOsQ,SAASC,KAAKzI,QAAQsI,EAAmB,IAC1DI,EAAgBH,EAAQvI,QAFf,MAE+B,IAAG2I,EAAAnV,EAC9BkG,EAAME,OAAO8E,KAAKU,MAAMnB,aAAcS,KAAKkB,OAAK,IAAnE,IAAA+I,EAAAjV,MAAA2U,EAAAM,EAAAhV,KAAAC,MAAqE,CAAA,IAA1DgQ,EAAIyE,EAAA/V,MAEb,IAAIJ,EAAKO,IAAImR,SAAIhP,OAASuJ,IAA1B,CAIA,IAAMsK,EAAO7E,EAAK6E,KAAKzI,QAAQsI,EAAmB,IAClD,GAAIG,IAASF,GAAWE,IAASC,EAAe,CAC9C9E,EAAKtB,UAAUC,IAAI7D,KAAKU,MAAMlC,mBAC9B0G,EAAKwC,aAAa,eAAgB,QAClC,IAAMuB,EAAczV,EAAKO,IAAImR,YAAIhP,OAAYuJ,IAK7C,GAJIwJ,GACFA,EAAYrF,UAAUC,IAAI7D,KAAKU,MAAMlC,mBAGnCwB,KAAKU,MAAM1C,iCAAkC,CAAA,IAC2CkM,EAD3CC,EAAArV,EAC7BkG,EAAMO,aAAa2J,EAAMlF,KAAKU,MAAMtB,YAAaY,KAAKU,MAAMrB,cAAY,IAA1F,IAAA8K,EAAAnV,MAAAkV,EAAAC,EAAAlV,KAAAC,MAA4F,CAAA,IAAjF0N,EAAGsH,EAAAtW,MACNkU,EAAatU,EAAKO,IAAI6O,gBAAG1M,OAAgBuJ,IAC/CqI,EAAWlE,UAAUC,IAAI7D,KAAKU,MAAMlC,mBACpC,IAAMyJ,EAAoBzU,EAAKO,IAAI+T,YAAU5R,OAAYuJ,IACrDwI,GACFA,EAAkBrE,UAAUC,IAAI7D,KAAKU,MAAMlC,0BAE9CrJ,GAAAgV,EAAA/U,EAAAD,WAAAgV,EAAA9U,eAGNF,GAAA8U,EAAA7U,EAAAD,WAAA8U,EAAA5U,QACF1B,yBAAAC,eAEkBwW,EAAgBC,GACjC,IAAMC,EAAYF,EAAe5F,aAAa,OAASxE,KAAKuB,mBAAqBvB,KAAK6B,OAChF0I,EAAQF,EAAW7F,aAAa,OAASxE,KAAKuB,mBAAqBvB,KAAK6B,OAE9EuI,EAAe1C,aAAa,KAAM4C,GAClCF,EAAe1C,aAAa,OAAQ,UACpC0C,EAAe1C,aAAa,gBAAiB6C,GAC7CH,EAAe1C,aAAa,gBAAiB,SAE7C2C,EAAW3C,aAAa,KAAM6C,GAC9BF,EAAW3C,aAAa,cAAe,QACvC2C,EAAW3C,aAAa,kBAAmB4C,MAC5C3W,eAAAC,eAEQF,GACP,GAAKsM,KAAK6C,cAAcnP,KAIpB+B,EAAOmD,QAAQoH,KAAKC,qBAAO/J,OAAeyJ,GAAqBjM,GAASyP,iBAA5E,CAIAnD,KAAKwK,aAAa9W,GAClB,IAAMoU,EAAatU,EAAKO,IAAIL,gBAAOwC,OAAgBuJ,IACnDqI,EAAWlE,UAAUQ,OAAOpE,KAAKU,MAAMnC,mBACvC,IAAM0J,EAAoBzU,EAAKO,IAAI+T,YAAU5R,OAAYuJ,IACrDwI,GACFA,EAAkBrE,UAAUQ,OAAOpE,KAAKU,MAAMnC,mBAC9C0J,EAAkBP,aAAa,gBAAiB,UAEhDI,EAAWJ,aAAa,gBAAiB,SAG3ChU,EAAQgU,aAAa,cAAe,QACpC1H,KAAKwB,aAAakD,OAAO1E,KAAKwB,aAAamD,QAAQjR,GAAU,GAC7D+B,EAAOmD,QAAQoH,KAAKC,eAAO/J,OAASyJ,GAAqBjM,OAC1DC,mBAAAC,eAEY+O,GACX,IAAK,IAAI8H,EAAQzK,KAAKwB,aAAa7M,OAAS,EAAG8V,GAAS9H,EAAO8H,IAC7DzK,KAAKkD,SAASlD,KAAKwB,aAAaiJ,OAEnC9W,oBAAAC,eAEaF,GACZ,OAAOA,EAAQkQ,UAAUpL,SAASwH,KAAKU,MAAM/B,cAI/ChL,mBAAAC,eACaF,GACX,IAAMgX,EAAahX,EAAQgF,QAAQsH,KAAKU,MAAMpB,cACxCqD,EAAQnP,EAAKO,IAAIL,UAAOwC,OAAUuJ,IAClCkL,EAAOjX,EAAQkQ,UAAUpL,SAASwH,KAAKU,MAAMpC,cAC7CsM,EAAW5K,KAAKC,QAAQ2D,UAAUpL,SAASwH,KAAKU,MAAMvC,qBACtD0M,EAA6B,IAAVlI,IAAgBiI,EACnCE,EAA2D,QAArD3R,EAAQC,iBAAiB4G,KAAKC,SAAS8K,UAC/CC,EAAeF,IAAQ9K,KAAKU,MAAMlD,wBAA4BsN,GAAO9K,KAAKU,MAAMlD,sBAChFkN,EAAWnS,YAAOrC,OAAKwJ,wBACzBsL,GAAeA,GAGjB,IAAIC,EAAWjL,KAAKU,MAAMjD,sBACtBiN,EAAWnS,YAAOrC,OAAKwJ,wBACzBuL,GAAYA,GAGd,IAAMC,EAAYF,EAAc,QAAU,OACpCG,EAAuBD,EAAU7K,OAAO,GAAGC,cAAgB4K,EAAU3K,MAAM,GAC3E6K,EAAYH,EAAW,SAAW,MAClCI,EAAuBD,EAAU/K,OAAO,GAAGC,cAAgB8K,EAAU7K,MAAM,GAC3E+K,EAAiBZ,EAAWlQ,wBAC5B+Q,EAAkBD,EAAeJ,GACjCM,EAAkBF,EAAeF,GACjCK,EAAkBtS,EAAQY,SAAS2Q,GACnCgB,EAAmBvS,EAAQO,UAAUgR,GACrCiB,EAAmBxS,EAAQC,iBAAiB1F,GAC5CkY,EAAuB,IAAVjJ,EAAc3C,KAAKU,MAAMhD,uBAAyBsC,KAAKU,MAAM9C,uBAC1EiO,EAAuB,IAAVlJ,GAAgBiI,EAA+C5K,KAAKU,MAAM7C,uBAAyB2C,OAAOC,WAAWkL,WAAgBzV,OAAUmV,YAA8B,IAAM7K,OAAOC,WAAWkL,YAAgBzV,OAAWmV,IAAyB,IAA9NrL,KAAKU,MAAM/C,uBACrDtB,EAAI,EACJE,EAAI,EAWR,GATIsO,GACFxO,EAAIuP,EACJrP,EAAImP,EAAmBG,IAEvBxP,EAAIoP,EAAkBG,EACtBrP,EAAIsP,GAIFlB,EAAM,CAER,IAAMmB,EAAmB9Q,EAAMtC,QAAQhF,EAAQ4H,eAAe,SAAAG,GAAM,MAAkD,WAA9CtC,EAAQC,iBAAiBqC,GAAQnB,YACzG,GAAIwR,EAAkB,CACpB,IAAMC,EAAuBD,EAAiBtR,wBACxCwR,EAAgC7S,EAAQC,iBAAiB0S,GAC3DjB,EACFtO,GAAKzB,KAAK+B,IAAI2O,EAAkBO,EAAqBX,IAAc5K,OAAOC,WAAWuL,WAA6B9V,OAAUmV,YAA8B,IAE1JhP,GAAKvB,KAAK+B,IAAI0O,EAAkBQ,EAAqBb,IAAc1K,OAAOC,WAAWuL,WAA6B9V,OAAUiV,YAA8B,KAMhK,GAAInL,KAAKU,MAAM5C,0BAA4B6M,EAAM,CAC/C,IAAMsB,EAAgB9S,EAAQW,mBACxBoS,EAAiB/S,EAAQS,oBACzBuS,EAAWhT,EAAQY,SAASrG,GAC5B0Y,EAAYjT,EAAQO,UAAUhG,GAC9B2Y,EAAcrB,EAAciB,EAAgBV,EAAkBA,EAC9De,EAAcrB,EAAWiB,EAAiBV,EAAkBA,EAC9DW,EAAWF,EACTpB,EACEwB,EAAchQ,EAAI8P,EAAWF,EAE/B5P,EAAI4P,EAAgBE,EAAWE,EACtBA,EAAchQ,EAAI,IAE3BA,GAAKgQ,GAEEA,EAAchQ,EAAI8P,EAAWF,IAGpC5P,EAFEuP,EAAaO,GAAYE,GAEtBT,EAAaO,EACTE,EAAcJ,EAAgBI,EAAcZ,EAAkB,GAGlEY,EAEDJ,EAAgBE,EAAWE,GAKnChQ,GAAKgQ,EAGFxB,IACCuB,EAAYF,EACVI,EAAc/P,EAAI6P,EAAYF,EAEhC3P,EAAI2P,EAAiBE,EAAYE,EACxBA,EAAc/P,EAAI,IAE3BA,GAAK+P,GAIP/P,EAAI0O,EAAWiB,EAAiBE,EAAYE,GAAeA,GAKjE,IAAMpS,EAAexG,EAAQyG,MAC7BD,EAAa4L,OAAS9F,KAAK4B,YAAc5B,KAAK4B,YAAc5B,KAAKuM,kBAAoB,EACjF5B,EACEE,EACF3Q,EAAakR,GAAa7O,EAAI,KAE9BrC,EAAagR,GAAa7O,EAAI,MAGhCnC,EAAagR,GAAa7O,EAAI,KAC9BnC,EAAakR,GAAa7O,EAAI,SAGlC5I,wBAAAC,eAEkBF,GAChB,IAAMwG,EAAexG,EAAQyG,MAC7BD,EAAa4L,OAAS,GACtB5L,EAAasS,IAAM,GACnBtS,EAAauS,KAAO,GACpBvS,EAAawS,OAAS,GACtBxS,EAAayS,MAAQ,MACtBhZ,eAAAC,eAEQF,GACP,IAAIsM,KAAK6C,cAAcnP,KAIlBF,EAAKO,IAAIL,0BAAOwC,OAA0BuJ,MAC7CjM,EAAKC,IAAIC,0BAAOwC,OAA0BuJ,IAAe,IACrDhK,EAAOmD,QAAQoH,KAAKC,0BAAO/J,OAAoByJ,GAAqBjM,GAASyP,qBAK/E1N,EAAOmD,QAAQoH,KAAKC,qBAAO/J,OAAeyJ,GAAqBjM,GAASyP,iBAA5E,CAIA3P,EAAKC,IAAIC,iBAAOwC,OAAiBuJ,IAAe,GAEhD,IAAMqI,EAAatU,EAAKO,IAAIL,gBAAOwC,OAAgBuJ,IACnDqI,EAAWlE,UAAUC,IAAI7D,KAAKU,MAAMnC,mBACpC,IAAM0J,EAAoBzU,EAAKO,IAAI+T,YAAU5R,OAAYuJ,IACrDwI,GACFA,EAAkBrE,UAAUC,IAAI7D,KAAKU,MAAMnC,mBAGvByB,KAAKgD,iBAEzBhD,KAAK4E,kBAAkBlR,GAEvBsM,KAAK4M,aAAalZ,GAGpBsM,KAAK6M,aAAanZ,GAEduU,EACFA,EAAkBP,aAAa,gBAAiB,QAEhDI,EAAWJ,aAAa,gBAAiB,QAG3ChU,EAAQgU,aAAa,cAAe,SAEpC1H,KAAKwB,aAAa/J,KAAK/D,GACvB+B,EAAOmD,QAAQoH,KAAKC,eAAO/J,OAASyJ,GAAqBjM,OAC1DC,8BAAAC,eAEuByE,GACjB2H,KAAK8I,kBAINrT,EAAOmD,QAAQoH,KAAKC,qBAAO/J,OAAeyJ,GAAqBK,KAAKe,WAAaf,KAAKgB,YAAc,MAAMmC,mBAI7D,YAA7CnD,KAAKU,MAAMvD,+BACb6C,KAAKoC,aAGHpC,KAAKe,WACPf,KAAKwK,aAAaxK,KAAKe,WAGrBf,KAAKgB,YACPhB,KAAKwK,aAAaxK,KAAKgB,YAGrBhB,KAAKiB,mBACPjB,KAAKwK,aAAaxK,KAAKiB,mBAGrBjB,KAAKY,gBACPZ,KAAKY,cAAcgD,UAAUQ,OAAOpE,KAAKU,MAAM/B,WAE/CnF,OAAOsQ,SAASgD,KAAOtT,OAAOsQ,SAASgD,KAAKxL,QAAQ,IAAIyL,YAAM7W,OAAM8J,KAAKY,cAAc4D,aAAa,YAAW,KAG7GxE,KAAKc,oBACPd,KAAKa,mBAAmBuG,QAG1B/O,EAAM0Q,iBACNtT,EAAOmD,QAAQoH,KAAKC,eAAO/J,OAASyJ,GAAqBK,KAAKe,WAAaf,KAAKgB,YAAc,WAC/FrN,8BAAAC,eAEuByE,EAAO3E,GACxBsM,KAAK8I,mBAILtV,EAAKO,IAAIL,0BAAOwC,OAA0BuJ,MAC7CjM,EAAKC,IAAIC,0BAAOwC,OAA0BuJ,IAAe,GACrDhK,EAAOmD,QAAQoH,KAAKC,0BAAO/J,OAAoByJ,GAAqBK,KAAKe,WAAaf,KAAKgB,YAAc,MAAMmC,mBAKjH1N,EAAOmD,QAAQoH,KAAKC,qBAAO/J,OAAeyJ,GAAqBK,KAAKe,WAAaf,KAAKgB,YAAc,MAAMmC,mBAI1GnD,KAAKe,WACPf,KAAK6M,aAAa7M,KAAKe,WAGrBf,KAAKgB,YACPhB,KAAK6M,aAAa7M,KAAKgB,YAGrBhB,KAAKiB,mBACPjB,KAAK6M,aAAa7M,KAAKiB,mBAGrBjB,KAAKY,eACPZ,KAAKY,cAAcgD,UAAUC,IAAI7D,KAAKU,MAAM/B,WAG1CqB,KAAKc,oBACPd,KAAKc,mBAAmBsG,QAG1B/O,EAAM0Q,iBACNtT,EAAOmD,QAAQoH,KAAKC,eAAO/J,OAASyJ,GAAqBK,KAAKe,WAAaf,KAAKgB,YAAc,WAC/FrN,iBAAAC,eAEUyE,GACT,GAAK2H,KAAK8I,oBAKJ,wBAAyBtP,SAA0B,sBAAfnB,EAAMoR,MAA8B,CAC5E,IAAMrE,EAAgBpF,KAAKgD,iBAErBhD,KAAK+B,iBAAmBqD,GAC5BpF,KAAKoC,aAGPpC,KAAK+B,gBAAkBqD,UAI3BzR,cAAAC,iBAEE,KAAOgM,EAAQjL,OAAS,GACtBiL,EAAQ,GAAGyD,UAGbxH,EAAiBC,aAClBnI,iBAAAC,iBAGC,QAAAmC,IAAAiX,EAAqBpN,EAAO7J,EAAAiX,EAAArY,OAAAoB,IAAXiX,EAAAjX,GACRqM,gBAEVzO,eAAAI,eA9kCC,OAAOE,KACRN,UAAAI,eAGC,MAAO,CAAEP,KAAAA,EAAMiC,OAAAA,EAAQ0D,QAAAA,EAAS6B,MAAAA,MACjCrH,uBAAAI,eAGC,OAAO8H,KACRlI,cAAAI,eAGC,OAAO6L,mCACRC,CAAA"}